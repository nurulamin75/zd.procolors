"use strict";(()=>{var Ye=Math.pow;var S=(e,t)=>()=>(e&&(t=e(e=0)),t);var cn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var H=(e,t,r)=>new Promise((o,n)=>{var a=f=>{try{l(r.next(f))}catch(i){n(i)}},s=f=>{try{l(r.throw(f))}catch(i){n(i)}},l=f=>f.done?o(f.value):Promise.resolve(f.value).then(a,s);l((r=r.apply(e,t)).next())});var te,Ze=S(()=>{_();te=(e,t=0,r=1)=>ue(pe(t,e),r)});var fe,Ht=S(()=>{Ze();fe=e=>{e._clipped=!1,e._unclipped=e.slice(0);for(let t=0;t<=3;t++)t<3?((e[t]<0||e[t]>255)&&(e._clipped=!0),e[t]=te(e[t],0,255)):t===3&&(e[t]=te(e[t],0,1));return e}});function L(e){return Wt[Object.prototype.toString.call(e)]||"object"}var Wt,Ie=S(()=>{Wt={};for(let e of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])Wt[`[object ${e}]`]=e.toLowerCase()});var E,Xt=S(()=>{Ie();E=(e,t=null)=>e.length>=3?Array.prototype.slice.call(e):L(e[0])=="object"&&t?t.split("").filter(r=>e[0][r]!==void 0).map(r=>e[0][r]):e[0]});var re,Yt=S(()=>{Ie();re=e=>{if(e.length<2)return null;let t=e.length-1;return L(e[t])=="string"?e[t].toLowerCase():null}});var xe,ue,pe,J,Me,Zt,Kt,_=S(()=>{Ht();Ze();Ie();Xt();Yt();({PI:xe,min:ue,max:pe}=Math),J=xe*2,Me=xe/3,Zt=xe/180,Kt=180/xe});var V,j=S(()=>{V={format:{},autodetect:[]}});var Ke,h,B=S(()=>{_();j();Ke=class{constructor(...t){let r=this;if(L(t[0])==="object"&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];let o=re(t),n=!1;if(!o){n=!0,V.sorted||(V.autodetect=V.autodetect.sort((a,s)=>s.p-a.p),V.sorted=!0);for(let a of V.autodetect)if(o=a.test(...t),o)break}if(V.format[o]){let a=V.format[o].apply(null,n?t:t.slice(0,-1));r._rgb=fe(a)}else throw new Error("unknown format: "+t);r._rgb.length===3&&r._rgb.push(1)}toString(){return L(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}},h=Ke});var Jt,Qt=S(()=>{Jt="2.6.0"});var Ae,T,z=S(()=>{B();Qt();Ae=(...e)=>new Ae.Color(...e);Ae.Color=h;Ae.version=Jt;T=Ae});var fn,er,tr=S(()=>{_();fn=(...e)=>{e=E(e,"cmyk");let[t,r,o,n]=e,a=e.length>4?e[4]:1;return n===1?[0,0,0,a]:[t>=1?0:255*(1-t)*(1-n),r>=1?0:255*(1-r)*(1-n),o>=1?0:255*(1-o)*(1-n),a]},er=fn});var rr,dn,or,nr=S(()=>{_();({max:rr}=Math),dn=(...e)=>{let[t,r,o]=E(e,"rgb");t=t/255,r=r/255,o=o/255;let n=1-rr(t,rr(r,o)),a=n<1?1/(1-n):0,s=(1-t-n)*a,l=(1-r-n)*a,f=(1-o-n)*a;return[s,l,f,n]},or=dn});var ar=S(()=>{z();B();j();_();tr();nr();h.prototype.cmyk=function(){return or(this._rgb)};T.cmyk=(...e)=>new h(...e,"cmyk");V.format.cmyk=er;V.autodetect.push({p:2,test:(...e)=>{if(e=E(e,"cmyk"),L(e)==="array"&&e.length===4)return"cmyk"}})});var Je,mn,ir,sr=S(()=>{_();Je=e=>Math.round(e*100)/100,mn=(...e)=>{let t=E(e,"hsla"),r=re(e)||"lsa";return t[0]=Je(t[0]||0),t[1]=Je(t[1]*100)+"%",t[2]=Je(t[2]*100)+"%",r==="hsla"||t.length>3&&t[3]<1?(t[3]=t.length>3?t[3]:1,r="hsla"):t.length=3,`${r}(${t.join(",")})`},ir=mn});var un,$e,Qe=S(()=>{_();un=(...e)=>{e=E(e,"rgba");let[t,r,o]=e;t/=255,r/=255,o/=255;let n=ue(t,r,o),a=pe(t,r,o),s=(a+n)/2,l,f;return a===n?(l=0,f=Number.NaN):l=s<.5?(a-n)/(a+n):(a-n)/(2-a-n),t==a?f=(r-o)/(a-n):r==a?f=2+(o-t)/(a-n):o==a&&(f=4+(t-r)/(a-n)),f*=60,f<0&&(f+=360),e.length>3&&e[3]!==void 0?[f,l,s,e[3]]:[f,l,s]},$e=un});var et,pn,lr,cr=S(()=>{_();sr();Qe();({round:et}=Math),pn=(...e)=>{let t=E(e,"rgba"),r=re(e)||"rgb";return r.substr(0,3)=="hsl"?ir($e(t),r):(t[0]=et(t[0]),t[1]=et(t[1]),t[2]=et(t[2]),(r==="rgba"||t.length>3&&t[3]<1)&&(t[3]=t.length>3?t[3]:1,r="rgba"),`${r}(${t.slice(0,r==="rgb"?3:4).join(",")})`)},lr=pn});var tt,gn,we,rt=S(()=>{_();({round:tt}=Math),gn=(...e)=>{e=E(e,"hsl");let[t,r,o]=e,n,a,s;if(r===0)n=a=s=o*255;else{let l=[0,0,0],f=[0,0,0],i=o<.5?o*(1+r):o+r-o*r,m=2*o-i,d=t/360;l[0]=d+1/3,l[1]=d,l[2]=d-1/3;for(let c=0;c<3;c++)l[c]<0&&(l[c]+=1),l[c]>1&&(l[c]-=1),6*l[c]<1?f[c]=m+(i-m)*6*l[c]:2*l[c]<1?f[c]=i:3*l[c]<2?f[c]=m+(i-m)*(2/3-l[c])*6:f[c]=m;[n,a,s]=[tt(f[0]*255),tt(f[1]*255),tt(f[2]*255)]}return e.length>3?[n,a,s,e[3]]:[n,a,s,1]},we=gn});var dr,mr,ur,pr,gr,br,fr,hr,ot,yr=S(()=>{rt();j();dr=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,mr=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,ur=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,pr=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,gr=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,br=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,{round:fr}=Math,hr=e=>{e=e.toLowerCase().trim();let t;if(V.format.named)try{return V.format.named(e)}catch(r){}if(t=e.match(dr)){let r=t.slice(1,4);for(let o=0;o<3;o++)r[o]=+r[o];return r[3]=1,r}if(t=e.match(mr)){let r=t.slice(1,5);for(let o=0;o<4;o++)r[o]=+r[o];return r}if(t=e.match(ur)){let r=t.slice(1,4);for(let o=0;o<3;o++)r[o]=fr(r[o]*2.55);return r[3]=1,r}if(t=e.match(pr)){let r=t.slice(1,5);for(let o=0;o<3;o++)r[o]=fr(r[o]*2.55);return r[3]=+r[3],r}if(t=e.match(gr)){let r=t.slice(1,4);r[1]*=.01,r[2]*=.01;let o=we(r);return o[3]=1,o}if(t=e.match(br)){let r=t.slice(1,4);r[1]*=.01,r[2]*=.01;let o=we(r);return o[3]=+t[4],o}};hr.test=e=>dr.test(e)||mr.test(e)||ur.test(e)||pr.test(e)||gr.test(e)||br.test(e);ot=hr});var kr=S(()=>{z();B();j();_();cr();yr();h.prototype.css=function(e){return lr(this._rgb,e)};T.css=(...e)=>new h(...e,"css");V.format.css=ot;V.autodetect.push({p:5,test:(e,...t)=>{if(!t.length&&L(e)==="string"&&ot.test(e))return"css"}})});var Ir=S(()=>{B();z();j();_();V.format.gl=(...e)=>{let t=E(e,"rgba");return t[0]*=255,t[1]*=255,t[2]*=255,t};T.gl=(...e)=>new h(...e,"gl");h.prototype.gl=function(){let e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]}});var bn,hn,wr,vr=S(()=>{_();({floor:bn}=Math),hn=(...e)=>{e=E(e,"hcg");let[t,r,o]=e,n,a,s;o=o*255;let l=r*255;if(r===0)n=a=s=o;else{t===360&&(t=0),t>360&&(t-=360),t<0&&(t+=360),t/=60;let f=bn(t),i=t-f,m=o*(1-r),d=m+l*(1-i),c=m+l*i,u=m+l;switch(f){case 0:[n,a,s]=[u,c,m];break;case 1:[n,a,s]=[d,u,m];break;case 2:[n,a,s]=[m,u,c];break;case 3:[n,a,s]=[m,d,u];break;case 4:[n,a,s]=[c,m,u];break;case 5:[n,a,s]=[u,m,d];break}}return[n,a,s,e.length>3?e[3]:1]},wr=hn});var yn,Cr,Sr=S(()=>{_();yn=(...e)=>{let[t,r,o]=E(e,"rgb"),n=ue(t,r,o),a=pe(t,r,o),s=a-n,l=s*100/255,f=n/(255-s)*100,i;return s===0?i=Number.NaN:(t===a&&(i=(r-o)/s),r===a&&(i=2+(o-t)/s),o===a&&(i=4+(t-r)/s),i*=60,i<0&&(i+=360)),[i,l,f]},Cr=yn});var nt=S(()=>{_();z();B();j();vr();Sr();h.prototype.hcg=function(){return Cr(this._rgb)};T.hcg=(...e)=>new h(...e,"hcg");V.format.hcg=wr;V.autodetect.push({p:1,test:(...e)=>{if(e=E(e,"hcg"),L(e)==="array"&&e.length===3)return"hcg"}})});var kn,In,wn,Ee,at=S(()=>{kn=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,In=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,wn=e=>{if(e.match(kn)){(e.length===4||e.length===7)&&(e=e.substr(1)),e.length===3&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);let t=parseInt(e,16),r=t>>16,o=t>>8&255,n=t&255;return[r,o,n,1]}if(e.match(In)){(e.length===5||e.length===9)&&(e=e.substr(1)),e.length===4&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);let t=parseInt(e,16),r=t>>24&255,o=t>>16&255,n=t>>8&255,a=Math.round((t&255)/255*100)/100;return[r,o,n,a]}throw new Error(`unknown hex color: ${e}`)},Ee=wn});var Ne,vn,Le,it=S(()=>{_();({round:Ne}=Math),vn=(...e)=>{let[t,r,o,n]=E(e,"rgba"),a=re(e)||"auto";n===void 0&&(n=1),a==="auto"&&(a=n<1?"rgba":"rgb"),t=Ne(t),r=Ne(r),o=Ne(o);let l="000000"+(t<<16|r<<8|o).toString(16);l=l.substr(l.length-6);let f="0"+Ne(n*255).toString(16);switch(f=f.substr(f.length-2),a.toLowerCase()){case"rgba":return`#${l}${f}`;case"argb":return`#${f}${l}`;default:return`#${l}`}},Le=vn});var xr=S(()=>{z();B();_();j();at();it();h.prototype.hex=function(e){return Le(this._rgb,e)};T.hex=(...e)=>new h(...e,"hex");V.format.hex=Ee;V.autodetect.push({p:4,test:(e,...t)=>{if(!t.length&&L(e)==="string"&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}})});var ge,Cn,Mr,Ar=S(()=>{_();({cos:ge}=Math),Cn=(...e)=>{e=E(e,"hsi");let[t,r,o]=e,n,a,s;return isNaN(t)&&(t=0),isNaN(r)&&(r=0),t>360&&(t-=360),t<0&&(t+=360),t/=360,t<1/3?(s=(1-r)/3,n=(1+r*ge(J*t)/ge(Me-J*t))/3,a=1-(s+n)):t<2/3?(t-=1/3,n=(1-r)/3,a=(1+r*ge(J*t)/ge(Me-J*t))/3,s=1-(n+a)):(t-=2/3,a=(1-r)/3,s=(1+r*ge(J*t)/ge(Me-J*t))/3,n=1-(a+s)),n=te(o*n*3),a=te(o*a*3),s=te(o*s*3),[n*255,a*255,s*255,e.length>3?e[3]:1]},Mr=Cn});var Sn,xn,Mn,An,$r,Er=S(()=>{_();({min:Sn,sqrt:xn,acos:Mn}=Math),An=(...e)=>{let[t,r,o]=E(e,"rgb");t/=255,r/=255,o/=255;let n,a=Sn(t,r,o),s=(t+r+o)/3,l=s>0?1-a/s:0;return l===0?n=NaN:(n=(t-r+(t-o))/2,n/=xn((t-r)*(t-r)+(t-o)*(r-o)),n=Mn(n),o>r&&(n=J-n),n/=J),[n*360,l,s]},$r=An});var st=S(()=>{_();z();B();j();Ar();Er();h.prototype.hsi=function(){return $r(this._rgb)};T.hsi=(...e)=>new h(...e,"hsi");V.format.hsi=Mr;V.autodetect.push({p:2,test:(...e)=>{if(e=E(e,"hsi"),L(e)==="array"&&e.length===3)return"hsi"}})});var Ve=S(()=>{_();z();B();j();rt();Qe();h.prototype.hsl=function(){return $e(this._rgb)};T.hsl=(...e)=>new h(...e,"hsl");V.format.hsl=we;V.autodetect.push({p:2,test:(...e)=>{if(e=E(e,"hsl"),L(e)==="array"&&e.length===3)return"hsl"}})});var $n,En,Nr,Lr=S(()=>{_();({floor:$n}=Math),En=(...e)=>{e=E(e,"hsv");let[t,r,o]=e,n,a,s;if(o*=255,r===0)n=a=s=o;else{t===360&&(t=0),t>360&&(t-=360),t<0&&(t+=360),t/=60;let l=$n(t),f=t-l,i=o*(1-r),m=o*(1-r*f),d=o*(1-r*(1-f));switch(l){case 0:[n,a,s]=[o,d,i];break;case 1:[n,a,s]=[m,o,i];break;case 2:[n,a,s]=[i,o,d];break;case 3:[n,a,s]=[i,m,o];break;case 4:[n,a,s]=[d,i,o];break;case 5:[n,a,s]=[o,i,m];break}}return[n,a,s,e.length>3?e[3]:1]},Nr=En});var Nn,Ln,Vn,Vr,Rr=S(()=>{_();({min:Nn,max:Ln}=Math),Vn=(...e)=>{e=E(e,"rgb");let[t,r,o]=e,n=Nn(t,r,o),a=Ln(t,r,o),s=a-n,l,f,i;return i=a/255,a===0?(l=Number.NaN,f=0):(f=s/a,t===a&&(l=(r-o)/s),r===a&&(l=2+(o-t)/s),o===a&&(l=4+(t-r)/s),l*=60,l<0&&(l+=360)),[l,f,i]},Vr=Vn});var lt=S(()=>{_();z();B();j();Lr();Rr();h.prototype.hsv=function(){return Vr(this._rgb)};T.hsv=(...e)=>new h(...e,"hsv");V.format.hsv=Nr;V.autodetect.push({p:2,test:(...e)=>{if(e=E(e,"hsv"),L(e)==="array"&&e.length===3)return"hsv"}})});var W,ve=S(()=>{W={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452}});var Rn,Pn,ct,ft,Re,dt=S(()=>{ve();_();({pow:Rn}=Math),Pn=(...e)=>{e=E(e,"lab");let[t,r,o]=e,n,a,s,l,f,i;return a=(t+16)/116,n=isNaN(r)?a:a+r/500,s=isNaN(o)?a:a-o/200,a=W.Yn*ft(a),n=W.Xn*ft(n),s=W.Zn*ft(s),l=ct(3.2404542*n-1.5371385*a-.4985314*s),f=ct(-.969266*n+1.8760108*a+.041556*s),i=ct(.0556434*n-.2040259*a+1.0572252*s),[l,f,i,e.length>3?e[3]:1]},ct=e=>255*(e<=.00304?12.92*e:1.055*Rn(e,1/2.4)-.055),ft=e=>e>W.t1?e*e*e:W.t2*(e-W.t0),Re=Pn});var Pr,Tn,mt,ut,On,Pe,pt=S(()=>{ve();_();({pow:Pr}=Math),Tn=(...e)=>{let[t,r,o]=E(e,"rgb"),[n,a,s]=On(t,r,o),l=116*a-16;return[l<0?0:l,500*(n-a),200*(a-s)]},mt=e=>(e/=255)<=.04045?e/12.92:Pr((e+.055)/1.055,2.4),ut=e=>e>W.t3?Pr(e,1/3):e/W.t2+W.t0,On=(e,t,r)=>{e=mt(e),t=mt(t),r=mt(r);let o=ut((.4124564*e+.3575761*t+.1804375*r)/W.Xn),n=ut((.2126729*e+.7151522*t+.072175*r)/W.Yn),a=ut((.0193339*e+.119192*t+.9503041*r)/W.Zn);return[o,n,a]},Pe=Tn});var be=S(()=>{_();z();B();j();dt();pt();h.prototype.lab=function(){return Pe(this._rgb)};T.lab=(...e)=>new h(...e,"lab");V.format.lab=Re;V.autodetect.push({p:2,test:(...e)=>{if(e=E(e,"lab"),L(e)==="array"&&e.length===3)return"lab"}})});var _n,Bn,Dn,Te,gt=S(()=>{_();({sin:_n,cos:Bn}=Math),Dn=(...e)=>{let[t,r,o]=E(e,"lch");return isNaN(o)&&(o=0),o=o*Zt,[t,Bn(o)*r,_n(o)*r]},Te=Dn});var Gn,Oe,bt=S(()=>{_();gt();dt();Gn=(...e)=>{e=E(e,"lch");let[t,r,o]=e,[n,a,s]=Te(t,r,o),[l,f,i]=Re(n,a,s);return[l,f,i,e.length>3?e[3]:1]},Oe=Gn});var Fn,Tr,Or=S(()=>{_();bt();Fn=(...e)=>{let t=E(e,"hcl").reverse();return Oe(...t)},Tr=Fn});var Un,zn,jn,qn,_e,ht=S(()=>{_();({sqrt:Un,atan2:zn,round:jn}=Math),qn=(...e)=>{let[t,r,o]=E(e,"lab"),n=Un(r*r+o*o),a=(zn(o,r)*Kt+360)%360;return jn(n*1e4)===0&&(a=Number.NaN),[t,n,a]},_e=qn});var Hn,yt,_r=S(()=>{_();pt();ht();Hn=(...e)=>{let[t,r,o]=E(e,"rgb"),[n,a,s]=Pe(t,r,o);return _e(n,a,s)},yt=Hn});var Ce=S(()=>{_();z();B();j();bt();Or();_r();h.prototype.lch=function(){return yt(this._rgb)};h.prototype.hcl=function(){return yt(this._rgb).reverse()};T.lch=(...e)=>new h(...e,"lch");T.hcl=(...e)=>new h(...e,"hcl");V.format.lch=Oe;V.format.hcl=Tr;["lch","hcl"].forEach(e=>V.autodetect.push({p:2,test:(...t)=>{if(t=E(t,e),L(t)==="array"&&t.length===3)return e}}))});var Wn,ie,kt=S(()=>{Wn={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},ie=Wn});var Br=S(()=>{B();j();_();kt();at();it();h.prototype.name=function(){let e=Le(this._rgb,"rgb");for(let t of Object.keys(ie))if(ie[t]===e)return t.toLowerCase();return e};V.format.named=e=>{if(e=e.toLowerCase(),ie[e])return Ee(ie[e]);throw new Error("unknown color name: "+e)};V.autodetect.push({p:5,test:(e,...t)=>{if(!t.length&&L(e)==="string"&&ie[e.toLowerCase()])return"named"}})});var Xn,Dr,Gr=S(()=>{_();Xn=e=>{if(L(e)=="number"&&e>=0&&e<=16777215){let t=e>>16,r=e>>8&255,o=e&255;return[t,r,o,1]}throw new Error("unknown num color: "+e)},Dr=Xn});var Yn,Fr,Ur=S(()=>{_();Yn=(...e)=>{let[t,r,o]=E(e,"rgb");return(t<<16)+(r<<8)+o},Fr=Yn});var It=S(()=>{z();B();j();_();Gr();Ur();h.prototype.num=function(){return Fr(this._rgb)};T.num=(...e)=>new h(...e,"num");V.format.num=Dr;V.autodetect.push({p:5,test:(...e)=>{if(e.length===1&&L(e[0])==="number"&&e[0]>=0&&e[0]<=16777215)return"num"}})});var zr,wt=S(()=>{z();B();j();_();({round:zr}=Math);h.prototype.rgb=function(e=!0){return e===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(zr)};h.prototype.rgba=function(e=!0){return this._rgb.slice(0,4).map((t,r)=>r<3?e===!1?t:zr(t):t)};T.rgb=(...e)=>new h(...e,"rgb");V.format.rgb=(...e)=>{let t=E(e,"rgba");return t[3]===void 0&&(t[3]=1),t};V.autodetect.push({p:3,test:(...e)=>{if(e=E(e,"rgba"),L(e)==="array"&&(e.length===3||e.length===4&&L(e[3])=="number"&&e[3]>=0&&e[3]<=1))return"rgb"}})});var Be,Zn,De,vt=S(()=>{({log:Be}=Math),Zn=e=>{let t=e/100,r,o,n;return t<66?(r=255,o=t<6?0:-155.25485562709179-.44596950469579133*(o=t-2)+104.49216199393888*Be(o),n=t<20?0:-254.76935184120902+.8274096064007395*(n=t-10)+115.67994401066147*Be(n)):(r=351.97690566805693+.114206453784165*(r=t-55)-40.25366309332127*Be(r),o=325.4494125711974+.07943456536662342*(o=t-50)-28.0852963507957*Be(o),n=255),[r,o,n,1]},De=Zn});var Kn,Jn,jr,qr=S(()=>{vt();_();({round:Kn}=Math),Jn=(...e)=>{let t=E(e,"rgb"),r=t[0],o=t[2],n=1e3,a=4e4,s=.4,l;for(;a-n>s;){l=(a+n)*.5;let f=De(l);f[2]/f[0]>=o/r?a=l:n=l}return Kn(l)},jr=Jn});var Hr=S(()=>{z();B();j();vt();qr();h.prototype.temp=h.prototype.kelvin=h.prototype.temperature=function(){return jr(this._rgb)};T.temp=T.kelvin=T.temperature=(...e)=>new h(...e,"temp");V.format.temp=V.format.kelvin=V.format.temperature=De});function Ct(e){let t=Math.abs(e);return t>.0031308?(Qn(e)||1)*(1.055*Ge(t,1/2.4)-.055):e*12.92}var Ge,Qn,ea,Fe,St=S(()=>{_();({pow:Ge,sign:Qn}=Math),ea=(...e)=>{e=E(e,"lab");let[t,r,o]=e,n=Ge(t+.3963377774*r+.2158037573*o,3),a=Ge(t-.1055613458*r-.0638541728*o,3),s=Ge(t-.0894841775*r-1.291485548*o,3);return[255*Ct(4.0767416621*n-3.3077115913*a+.2309699292*s),255*Ct(-1.2684380046*n+2.6097574011*a-.3413193965*s),255*Ct(-.0041960863*n-.7034186147*a+1.707614701*s),e.length>3?e[3]:1]},Fe=ea});function Mt(e){let t=Math.abs(e);return t<.04045?e/12.92:(ra(e)||1)*ta((t+.055)/1.055,2.4)}var xt,ta,ra,oa,Ue,At=S(()=>{_();({cbrt:xt,pow:ta,sign:ra}=Math),oa=(...e)=>{let[t,r,o]=E(e,"rgb"),[n,a,s]=[Mt(t/255),Mt(r/255),Mt(o/255)],l=xt(.4122214708*n+.5363325363*a+.0514459929*s),f=xt(.2119034982*n+.6806995451*a+.1073969566*s),i=xt(.0883024619*n+.2817188376*a+.6299787005*s);return[.2104542553*l+.793617785*f-.0040720468*i,1.9779984951*l-2.428592205*f+.4505937099*i,.0259040371*l+.7827717662*f-.808675766*i]},Ue=oa});var $t=S(()=>{_();z();B();j();St();At();h.prototype.oklab=function(){return Ue(this._rgb)};T.oklab=(...e)=>new h(...e,"oklab");V.format.oklab=Fe;V.autodetect.push({p:3,test:(...e)=>{if(e=E(e,"oklab"),L(e)==="array"&&e.length===3)return"oklab"}})});var na,Wr,Xr=S(()=>{_();gt();St();na=(...e)=>{e=E(e,"lch");let[t,r,o]=e,[n,a,s]=Te(t,r,o),[l,f,i]=Fe(n,a,s);return[l,f,i,e.length>3?e[3]:1]},Wr=na});var aa,Yr,Zr=S(()=>{_();At();ht();aa=(...e)=>{let[t,r,o]=E(e,"rgb"),[n,a,s]=Ue(t,r,o);return _e(n,a,s)},Yr=aa});var Kr=S(()=>{_();z();B();j();Xr();Zr();h.prototype.oklch=function(){return Yr(this._rgb)};T.oklch=(...e)=>new h(...e,"oklch");V.format.oklch=Wr;V.autodetect.push({p:3,test:(...e)=>{if(e=E(e,"oklch"),L(e)==="array"&&e.length===3)return"oklch"}})});var Jr=S(()=>{B();_();h.prototype.alpha=function(e,t=!1){return e!==void 0&&L(e)==="number"?t?(this._rgb[3]=e,this):new h([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]}});var Qr=S(()=>{B();h.prototype.clipped=function(){return this._rgb._clipped||!1}});var eo=S(()=>{be();B();ve();h.prototype.darken=function(e=1){let t=this,r=t.lab();return r[0]-=W.Kn*e,new h(r,"lab").alpha(t.alpha(),!0)};h.prototype.brighten=function(e=1){return this.darken(-e)};h.prototype.darker=h.prototype.darken;h.prototype.brighter=h.prototype.brighten});var to=S(()=>{B();h.prototype.get=function(e){let[t,r]=e.split("."),o=this[t]();if(r){let n=t.indexOf(r)-(t.substr(0,2)==="ok"?2:0);if(n>-1)return o[n];throw new Error(`unknown channel ${r} in mode ${t}`)}else return o}});var ia,sa,la,ca,Et,Nt=S(()=>{B();_();({pow:ia}=Math),sa=1e-7,la=20;h.prototype.luminance=function(e,t="rgb"){if(e!==void 0&&L(e)==="number"){if(e===0)return new h([0,0,0,this._rgb[3]],"rgb");if(e===1)return new h([255,255,255,this._rgb[3]],"rgb");let r=this.luminance(),o=la,n=(s,l)=>{let f=s.interpolate(l,.5,t),i=f.luminance();return Math.abs(e-i)<sa||!o--?f:i>e?n(s,f):n(f,l)},a=(r>e?n(new h([0,0,0]),this):n(this,new h([255,255,255]))).rgb();return new h([...a,this._rgb[3]])}return ca(...this._rgb.slice(0,3))};ca=(e,t,r)=>(e=Et(e),t=Et(t),r=Et(r),.2126*e+.7152*t+.0722*r),Et=e=>(e/=255,e<=.03928?e/12.92:ia((e+.055)/1.055,2.4))});var F,Z=S(()=>{F={}});var se,ze=S(()=>{B();_();Z();se=(e,t,r=.5,...o)=>{let n=o[0]||"lrgb";if(!F[n]&&!o.length&&(n=Object.keys(F)[0]),!F[n])throw new Error(`interpolation mode ${n} is not defined`);return L(e)!=="object"&&(e=new h(e)),L(t)!=="object"&&(t=new h(t)),F[n](e,t,r).alpha(e.alpha()+r*(t.alpha()-e.alpha()))}});var ro=S(()=>{B();ze();h.prototype.mix=h.prototype.interpolate=function(e,t=.5,...r){return se(this,e,t,...r)}});var oo=S(()=>{B();h.prototype.premultiply=function(e=!1){let t=this._rgb,r=t[3];return e?(this._rgb=[t[0]*r,t[1]*r,t[2]*r,r],this):new h([t[0]*r,t[1]*r,t[2]*r,r],"rgb")}});var no=S(()=>{Ce();B();ve();h.prototype.saturate=function(e=1){let t=this,r=t.lch();return r[1]+=W.Kn*e,r[1]<0&&(r[1]=0),new h(r,"lch").alpha(t.alpha(),!0)};h.prototype.desaturate=function(e=1){return this.saturate(-e)}});var ao=S(()=>{B();_();h.prototype.set=function(e,t,r=!1){let[o,n]=e.split("."),a=this[o]();if(n){let s=o.indexOf(n)-(o.substr(0,2)==="ok"?2:0);if(s>-1){if(L(t)=="string")switch(t.charAt(0)){case"+":a[s]+=+t;break;case"-":a[s]+=+t;break;case"*":a[s]*=+t.substr(1);break;case"/":a[s]/=+t.substr(1);break;default:a[s]=+t}else if(L(t)==="number")a[s]=t;else throw new Error("unsupported value for Color.set");let l=new h(a,o);return r?(this._rgb=l._rgb,this):l}throw new Error(`unknown channel ${n} in mode ${o}`)}else return a}});var io=S(()=>{be();B();ze();h.prototype.tint=function(e=.5,...t){return se(this,"white",e,...t)};h.prototype.shade=function(e=.5,...t){return se(this,"black",e,...t)}});var fa,so=S(()=>{B();Z();fa=(e,t,r)=>{let o=e._rgb,n=t._rgb;return new h(o[0]+r*(n[0]-o[0]),o[1]+r*(n[1]-o[1]),o[2]+r*(n[2]-o[2]),"rgb")};F.rgb=fa});var Lt,he,da,lo=S(()=>{B();Z();({sqrt:Lt,pow:he}=Math),da=(e,t,r)=>{let[o,n,a]=e._rgb,[s,l,f]=t._rgb;return new h(Lt(he(o,2)*(1-r)+he(s,2)*r),Lt(he(n,2)*(1-r)+he(l,2)*r),Lt(he(a,2)*(1-r)+he(f,2)*r),"rgb")};F.lrgb=da});var ma,co=S(()=>{be();Z();B();ma=(e,t,r)=>{let o=e.lab(),n=t.lab();return new h(o[0]+r*(n[0]-o[0]),o[1]+r*(n[1]-o[1]),o[2]+r*(n[2]-o[2]),"lab")};F.lab=ma});var Q,de=S(()=>{B();Q=(e,t,r,o)=>{let n,a;o==="hsl"?(n=e.hsl(),a=t.hsl()):o==="hsv"?(n=e.hsv(),a=t.hsv()):o==="hcg"?(n=e.hcg(),a=t.hcg()):o==="hsi"?(n=e.hsi(),a=t.hsi()):o==="lch"||o==="hcl"?(o="hcl",n=e.hcl(),a=t.hcl()):o==="oklch"&&(n=e.oklch().reverse(),a=t.oklch().reverse());let s,l,f,i,m,d;(o.substr(0,1)==="h"||o==="oklch")&&([s,f,m]=n,[l,i,d]=a);let c,u,y,g;return!isNaN(s)&&!isNaN(l)?(l>s&&l-s>180?g=l-(s+360):l<s&&s-l>180?g=l+360-s:g=l-s,u=s+r*g):isNaN(s)?isNaN(l)?u=Number.NaN:(u=l,(m==1||m==0)&&o!="hsv"&&(c=i)):(u=s,(d==1||d==0)&&o!="hsv"&&(c=f)),c===void 0&&(c=f+r*(i-f)),y=m+r*(d-m),o==="oklch"?new h([y,c,u],o):new h([u,c,y],o)}});var fo,mo=S(()=>{Ce();de();Z();fo=(e,t,r)=>Q(e,t,r,"lch");F.lch=fo;F.hcl=fo});var ua,uo=S(()=>{It();Z();B();ua=(e,t,r)=>{let o=e.num(),n=t.num();return new h(o+r*(n-o),"num")};F.num=ua});var pa,po=S(()=>{nt();de();Z();pa=(e,t,r)=>Q(e,t,r,"hcg");F.hcg=pa});var ga,go=S(()=>{st();de();Z();ga=(e,t,r)=>Q(e,t,r,"hsi");F.hsi=ga});var ba,bo=S(()=>{Ve();de();Z();ba=(e,t,r)=>Q(e,t,r,"hsl");F.hsl=ba});var ha,ho=S(()=>{lt();de();Z();ha=(e,t,r)=>Q(e,t,r,"hsv");F.hsv=ha});var ya,yo=S(()=>{$t();Z();B();ya=(e,t,r)=>{let o=e.oklab(),n=t.oklab();return new h(o[0]+r*(n[0]-o[0]),o[1]+r*(n[1]-o[1]),o[2]+r*(n[2]-o[2]),"oklab")};F.oklab=ya});var ka,ko=S(()=>{Ce();de();Z();ka=(e,t,r)=>Q(e,t,r,"oklch");F.oklch=ka});var Vt,Rt,Pt,Io,wo,Ia,vo,wa,Co=S(()=>{B();_();({pow:Vt,sqrt:Rt,PI:Pt,cos:Io,sin:wo,atan2:Ia}=Math),vo=(e,t="lrgb",r=null)=>{let o=e.length;r||(r=Array.from(new Array(o)).map(()=>1));let n=o/r.reduce(function(d,c){return d+c});if(r.forEach((d,c)=>{r[c]*=n}),e=e.map(d=>new h(d)),t==="lrgb")return wa(e,r);let a=e.shift(),s=a.get(t),l=[],f=0,i=0;for(let d=0;d<s.length;d++)if(s[d]=(s[d]||0)*r[0],l.push(isNaN(s[d])?0:r[0]),t.charAt(d)==="h"&&!isNaN(s[d])){let c=s[d]/180*Pt;f+=Io(c)*r[0],i+=wo(c)*r[0]}let m=a.alpha()*r[0];e.forEach((d,c)=>{let u=d.get(t);m+=d.alpha()*r[c+1];for(let y=0;y<s.length;y++)if(!isNaN(u[y]))if(l[y]+=r[c+1],t.charAt(y)==="h"){let g=u[y]/180*Pt;f+=Io(g)*r[c+1],i+=wo(g)*r[c+1]}else s[y]+=u[y]*r[c+1]});for(let d=0;d<s.length;d++)if(t.charAt(d)==="h"){let c=Ia(i/l[d],f/l[d])/Pt*180;for(;c<0;)c+=360;for(;c>=360;)c-=360;s[d]=c}else s[d]=s[d]/l[d];return m/=o,new h(s,t).alpha(m>.99999?1:m,!0)},wa=(e,t)=>{let r=e.length,o=[0,0,0,0];for(let n=0;n<e.length;n++){let a=e[n],s=t[n]/r,l=a._rgb;o[0]+=Vt(l[0],2)*s,o[1]+=Vt(l[1],2)*s,o[2]+=Vt(l[2],2)*s,o[3]+=l[3]*s}return o[0]=Rt(o[0]),o[1]=Rt(o[1]),o[2]=Rt(o[2]),o[3]>.9999999&&(o[3]=1),new h(fe(o))}});function me(e){let t="rgb",r=T("#ccc"),o=0,n=[0,1],a=[],s=[0,0],l=!1,f=[],i=!1,m=0,d=1,c=!1,u={},y=!0,g=1,b=function(p){if(p=p||["#fff","#000"],p&&L(p)==="string"&&T.brewer&&T.brewer[p.toLowerCase()]&&(p=T.brewer[p.toLowerCase()]),L(p)==="array"){p.length===1&&(p=[p[0],p[0]]),p=p.slice(0);for(let v=0;v<p.length;v++)p[v]=T(p[v]);a.length=0;for(let v=0;v<p.length;v++)a.push(v/(p.length-1))}return C(),f=p},I=function(p){if(l!=null){let v=l.length-1,x=0;for(;x<v&&p>=l[x];)x++;return x-1}return 0},$=p=>p,N=p=>p,k=function(p,v){let x,A;if(v==null&&(v=!1),isNaN(p)||p===null)return r;v?A=p:l&&l.length>2?A=I(p)/(l.length-2):d!==m?A=(p-m)/(d-m):A=1,A=N(A),v||(A=$(A)),g!==1&&(A=va(A,g)),A=s[0]+A*(1-s[0]-s[1]),A=te(A,0,1);let R=Math.floor(A*1e4);if(y&&u[R])x=u[R];else{if(L(f)==="array")for(let M=0;M<a.length;M++){let O=a[M];if(A<=O){x=f[M];break}if(A>=O&&M===a.length-1){x=f[M];break}if(A>O&&A<a[M+1]){A=(A-O)/(a[M+1]-O),x=T.interpolate(f[M],f[M+1],A,t);break}}else L(f)==="function"&&(x=f(A));y&&(u[R]=x)}return x};var C=()=>u={};b(e);let w=function(p){let v=T(k(p));return i&&v[i]?v[i]():v};return w.classes=function(p){if(p!=null){if(L(p)==="array")l=p,n=[p[0],p[p.length-1]];else{let v=T.analyze(n);p===0?l=[v.min,v.max]:l=T.limits(v,"e",p)}return w}return l},w.domain=function(p){if(!arguments.length)return n;m=p[0],d=p[p.length-1],a=[];let v=f.length;if(p.length===v&&m!==d)for(let x of Array.from(p))a.push((x-m)/(d-m));else{for(let x=0;x<v;x++)a.push(x/(v-1));if(p.length>2){let x=p.map((R,M)=>M/(p.length-1)),A=p.map(R=>(R-m)/(d-m));A.every((R,M)=>x[M]===R)||(N=R=>{if(R<=0||R>=1)return R;let M=0;for(;R>=A[M+1];)M++;let O=(R-A[M])/(A[M+1]-A[M]);return x[M]+O*(x[M+1]-x[M])})}}return n=[m,d],w},w.mode=function(p){return arguments.length?(t=p,C(),w):t},w.range=function(p,v){return b(p,v),w},w.out=function(p){return i=p,w},w.spread=function(p){return arguments.length?(o=p,w):o},w.correctLightness=function(p){return p==null&&(p=!0),c=p,C(),c?$=function(v){let x=k(0,!0).lab()[0],A=k(1,!0).lab()[0],R=x>A,M=k(v,!0).lab()[0],O=x+(A-x)*v,D=M-O,G=0,P=1,U=20;for(;Math.abs(D)>.01&&U-- >0;)(function(){return R&&(D*=-1),D<0?(G=v,v+=(P-v)*.5):(P=v,v+=(G-v)*.5),M=k(v,!0).lab()[0],D=M-O})();return v}:$=v=>v,w},w.padding=function(p){return p!=null?(L(p)==="number"&&(p=[p,p]),s=p,w):s},w.colors=function(p,v){arguments.length<2&&(v="hex");let x=[];if(arguments.length===0)x=f.slice(0);else if(p===1)x=[w(.5)];else if(p>1){let A=n[0],R=n[1]-A;x=Ca(0,p,!1).map(M=>w(A+M/(p-1)*R))}else{e=[];let A=[];if(l&&l.length>2)for(let R=1,M=l.length,O=1<=M;O?R<M:R>M;O?R++:R--)A.push((l[R-1]+l[R])*.5);else A=n;x=A.map(R=>w(R))}return T[v]&&(x=x.map(A=>A[v]())),x},w.cache=function(p){return p!=null?(y=p,w):y},w.gamma=function(p){return p!=null?(g=p,w):g},w.nodata=function(p){return p!=null?(r=T(p),w):r},w}function Ca(e,t,r){let o=[],n=e<t,a=r?n?t+1:t-1:t;for(let s=e;n?s<a:s>a;n?s++:s--)o.push(s);return o}var va,je=S(()=>{z();_();({pow:va}=Math)});var Sa,xa,So,xo=S(()=>{B();be();je();Sa=function(e){let t=[1,1];for(let r=1;r<e;r++){let o=[1];for(let n=1;n<=t.length;n++)o[n]=(t[n]||0)+t[n-1];t=o}return t},xa=function(e){let t,r,o,n;if(e=e.map(a=>new h(a)),e.length===2)[r,o]=e.map(a=>a.lab()),t=function(a){let s=[0,1,2].map(l=>r[l]+a*(o[l]-r[l]));return new h(s,"lab")};else if(e.length===3)[r,o,n]=e.map(a=>a.lab()),t=function(a){let s=[0,1,2].map(l=>(1-a)*(1-a)*r[l]+2*(1-a)*a*o[l]+a*a*n[l]);return new h(s,"lab")};else if(e.length===4){let a;[r,o,n,a]=e.map(s=>s.lab()),t=function(s){let l=[0,1,2].map(f=>(1-s)*(1-s)*(1-s)*r[f]+3*(1-s)*(1-s)*s*o[f]+3*(1-s)*s*s*n[f]+s*s*s*a[f]);return new h(l,"lab")}}else if(e.length>=5){let a,s,l;a=e.map(f=>f.lab()),l=e.length-1,s=Sa(l),t=function(f){let i=1-f,m=[0,1,2].map(d=>a.reduce((c,u,y)=>c+s[y]*Ye(i,l-y)*Ye(f,y)*u[d],0));return new h(m,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return t},So=e=>{let t=xa(e);return t.scale=()=>me(t),t}});var ee,le,ce,Ma,Aa,$a,Ea,Na,La,Va,Ra,Mo,Ao=S(()=>{wt();z();ee=(e,t,r)=>{if(!ee[r])throw new Error("unknown blend mode "+r);return ee[r](e,t)},le=e=>(t,r)=>{let o=T(r).rgb(),n=T(t).rgb();return T.rgb(e(o,n))},ce=e=>(t,r)=>{let o=[];return o[0]=e(t[0],r[0]),o[1]=e(t[1],r[1]),o[2]=e(t[2],r[2]),o},Ma=e=>e,Aa=(e,t)=>e*t/255,$a=(e,t)=>e>t?t:e,Ea=(e,t)=>e>t?e:t,Na=(e,t)=>255*(1-(1-e/255)*(1-t/255)),La=(e,t)=>t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255)),Va=(e,t)=>255*(1-(1-t/255)/(e/255)),Ra=(e,t)=>e===255?255:(e=255*(t/255)/(1-e/255),e>255?255:e);ee.normal=le(ce(Ma));ee.multiply=le(ce(Aa));ee.screen=le(ce(Na));ee.overlay=le(ce(La));ee.darken=le(ce($a));ee.lighten=le(ce(Ea));ee.dodge=le(ce(Ra));ee.burn=le(ce(Va));Mo=ee});function $o(e=300,t=-1.5,r=1,o=1,n=[0,1]){let a=0,s;L(n)==="array"?s=n[1]-n[0]:(s=0,n=[n,n]);let l=function(f){let i=J*((e+120)/360+t*f),m=Pa(n[0]+s*f,o),c=(a!==0?r[0]+f*a:r)*m*(1-m)/2,u=Oa(i),y=Ta(i),g=m+c*(-.14861*u+1.78277*y),b=m+c*(-.29227*u-.90649*y),I=m+c*(1.97294*u);return T(fe([g*255,b*255,I*255,1]))};return l.start=function(f){return f==null?e:(e=f,l)},l.rotations=function(f){return f==null?t:(t=f,l)},l.gamma=function(f){return f==null?o:(o=f,l)},l.hue=function(f){return f==null?r:(r=f,L(r)==="array"?(a=r[1]-r[0],a===0&&(r=r[1])):a=0,l)},l.lightness=function(f){return f==null?n:(L(f)==="array"?(n=f,s=f[1]-f[0]):(n=[f,f],s=0),l)},l.scale=()=>T.scale(l),l.hue(r),l}var Pa,Ta,Oa,Eo=S(()=>{_();z();({pow:Pa,sin:Ta,cos:Oa}=Math)});var _a,Ba,Da,No,Lo=S(()=>{B();_a="0123456789abcdef",{floor:Ba,random:Da}=Math,No=()=>{let e="#";for(let t=0;t<6;t++)e+=_a.charAt(Ba(Da()*16));return new h(e,"hex")}});function Tt(e,t=null){let r={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return L(e)==="object"&&(e=Object.values(e)),e.forEach(o=>{t&&L(o)==="object"&&(o=o[t]),o!=null&&!isNaN(o)&&(r.values.push(o),r.sum+=o,o<r.min&&(r.min=o),o>r.max&&(r.max=o),r.count+=1)}),r.domain=[r.min,r.max],r.limits=(o,n)=>Ot(r,o,n),r}function Ot(e,t="equal",r=7){L(e)=="array"&&(e=Tt(e));let{min:o,max:n}=e,a=e.values.sort((l,f)=>l-f);if(r===1)return[o,n];let s=[];if(t.substr(0,1)==="c"&&(s.push(o),s.push(n)),t.substr(0,1)==="e"){s.push(o);for(let l=1;l<r;l++)s.push(o+l/r*(n-o));s.push(n)}else if(t.substr(0,1)==="l"){if(o<=0)throw new Error("Logarithmic scales are only possible for values > 0");let l=Math.LOG10E*Vo(o),f=Math.LOG10E*Vo(n);s.push(o);for(let i=1;i<r;i++)s.push(Ga(10,l+i/r*(f-l)));s.push(n)}else if(t.substr(0,1)==="q"){s.push(o);for(let l=1;l<r;l++){let f=(a.length-1)*l/r,i=Fa(f);if(i===f)s.push(a[i]);else{let m=f-i;s.push(a[i]*(1-m)+a[i+1]*m)}}s.push(n)}else if(t.substr(0,1)==="k"){let l,f=a.length,i=new Array(f),m=new Array(r),d=!0,c=0,u=null;u=[],u.push(o);for(let b=1;b<r;b++)u.push(o+b/r*(n-o));for(u.push(n);d;){for(let I=0;I<r;I++)m[I]=0;for(let I=0;I<f;I++){let $=a[I],N=Number.MAX_VALUE,k;for(let C=0;C<r;C++){let w=Ua(u[C]-$);w<N&&(N=w,k=C),m[k]++,i[I]=k}}let b=new Array(r);for(let I=0;I<r;I++)b[I]=null;for(let I=0;I<f;I++)l=i[I],b[l]===null?b[l]=a[I]:b[l]+=a[I];for(let I=0;I<r;I++)b[I]*=1/m[I];d=!1;for(let I=0;I<r;I++)if(b[I]!==u[I]){d=!0;break}u=b,c++,c>200&&(d=!1)}let y={};for(let b=0;b<r;b++)y[b]=[];for(let b=0;b<f;b++)l=i[b],y[l].push(a[b]);let g=[];for(let b=0;b<r;b++)g.push(y[b][0]),g.push(y[b][y[b].length-1]);g=g.sort((b,I)=>b-I),s.push(g[0]);for(let b=1;b<g.length;b+=2){let I=g[b];!isNaN(I)&&s.indexOf(I)===-1&&s.push(I)}}return s}var Vo,Ga,Fa,Ua,_t=S(()=>{Ie();({log:Vo,pow:Ga,floor:Fa,abs:Ua}=Math)});var Ro,Po=S(()=>{B();Nt();Ro=(e,t)=>{e=new h(e),t=new h(t);let r=e.luminance(),o=t.luminance();return r>o?(r+.05)/(o+.05):(o+.05)/(r+.05)}});function Do(e,t,r=1,o=1,n=1){var a=function(Xe){return 360*Xe/(2*Bo)},s=function(Xe){return 2*Bo*Xe/360};e=new h(e),t=new h(t);let[l,f,i]=Array.from(e.lab()),[m,d,c]=Array.from(t.lab()),u=(l+m)/2,y=oe(q(f,2)+q(i,2)),g=oe(q(d,2)+q(c,2)),b=(y+g)/2,I=.5*(1-oe(q(b,7)/(q(b,7)+q(25,7)))),$=f*(1+I),N=d*(1+I),k=oe(q($,2)+q(i,2)),C=oe(q(N,2)+q(c,2)),w=(k+C)/2,p=a(To(i,$)),v=a(To(c,N)),x=p>=0?p:p+360,A=v>=0?v:v+360,R=Oo(x-A)>180?(x+A+360)/2:(x+A)/2,M=1-.17*qe(s(R-30))+.24*qe(s(2*R))+.32*qe(s(3*R+6))-.2*qe(s(4*R-63)),O=A-x;O=Oo(O)<=180?O:A<=x?O+360:O-360,O=2*oe(k*C)*_o(s(O)/2);let D=m-l,G=C-k,P=1+.015*q(u-50,2)/oe(20+q(u-50,2)),U=1+.045*w,Y=1+.015*w*M,K=30*qa(-q((R-275)/25,2)),ye=-(2*oe(q(w,7)/(q(w,7)+q(25,7))))*_o(2*s(K)),ke=oe(q(D/(r*P),2)+q(G/(o*U),2)+q(O/(n*Y),2)+ye*(G/(o*U))*(O/(n*Y)));return ja(0,za(100,ke))}var oe,q,za,ja,To,Oo,qe,_o,qa,Bo,Go=S(()=>{B();({sqrt:oe,pow:q,min:za,max:ja,atan2:To,abs:Oo,cos:qe,sin:_o,exp:qa,PI:Bo}=Math)});function Fo(e,t,r="lab"){e=new h(e),t=new h(t);let o=e.get(r),n=t.get(r),a=0;for(let s in o){let l=(o[s]||0)-(n[s]||0);a+=l*l}return Math.sqrt(a)}var Uo=S(()=>{B()});var zo,jo=S(()=>{B();zo=(...e)=>{try{return new h(...e),!0}catch(t){return!1}}});var qo,Ho=S(()=>{z();Ve();je();qo={cool(){return me([T.hsl(180,1,.9),T.hsl(250,.7,.4)])},hot(){return me(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")}}});var He,Wo,Xo=S(()=>{He={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]};for(let e of Object.keys(He))He[e.toLowerCase()]=He[e];Wo=He});var ne,Yo=S(()=>{z();ar();kr();Ir();nt();xr();st();Ve();lt();be();Ce();Br();It();wt();Hr();$t();Kr();Jr();Qr();eo();to();Nt();ro();oo();no();ao();io();so();lo();co();mo();uo();po();go();bo();ho();yo();ko();Co();xo();Ao();Eo();ze();Lo();je();_t();Po();Go();Uo();_t();jo();j();Ho();kt();Xo();Object.assign(T,{average:vo,bezier:So,blend:Mo,cubehelix:$o,mix:se,interpolate:se,random:No,scale:me,analyze:Tt,contrast:Ro,deltaE:Do,distance:Fo,limits:Ot,valid:zo,scales:qo,input:V,colors:ie,brewer:Wo});ne=T});function Bt(e){return e.type==="SOLID"&&"boundVariables"in e&&e.boundVariables?Object.keys(e.boundVariables).length>0:!1}function Dt(e,t){return t==="fill"&&"fillStyleId"in e?e.fillStyleId!==figma.mixed&&e.fillStyleId!=="":t==="stroke"&&"strokeStyleId"in e?e.strokeStyleId!==figma.mixed&&e.strokeStyleId!=="":t==="text"&&e.type==="TEXT"&&"fillStyleId"in e?e.fillStyleId!==figma.mixed&&e.fillStyleId!=="":!1}function Gt(e){return e.type==="SOLID"?{r:e.color.r,g:e.color.g,b:e.color.b}:null}function Ha(e){let t=[];return"visible"in e&&e.visible===!1||("fills"in e&&Array.isArray(e.fills)&&!Dt(e,"fill")&&e.fills.forEach((r,o)=>{if(r.type==="SOLID"&&!Bt(r)){let n=Gt(r);n&&t.push({nodeId:e.id,nodeName:e.name,property:"fill",rawColor:n,originalPaint:r})}}),"strokes"in e&&Array.isArray(e.strokes)&&!Dt(e,"stroke")&&e.strokes.forEach((r,o)=>{if(r.type==="SOLID"&&!Bt(r)){let n=Gt(r);n&&t.push({nodeId:e.id,nodeName:e.name,property:"stroke",rawColor:n,originalPaint:r})}}),e.type==="TEXT"&&"fills"in e&&Array.isArray(e.fills)&&!Dt(e,"text")&&e.fills.forEach(r=>{if(r.type==="SOLID"&&!Bt(r)){let o=Gt(r);o&&t.push({nodeId:e.id,nodeName:e.name,property:"text",rawColor:o,originalPaint:r})}})),t}function Ft(e){let t=[];function r(o){if(t.push(...Ha(o)),"children"in o)for(let n of o.children)r(n)}for(let o of e)r(o);return t}function Zo(e){return Ft(e.children)}var Ko=S(()=>{"use strict"});function Ut(e){let t=e.r>.04045?Math.pow((e.r+.055)/1.055,2.4):e.r/12.92,r=e.g>.04045?Math.pow((e.g+.055)/1.055,2.4):e.g/12.92,o=e.b>.04045?Math.pow((e.b+.055)/1.055,2.4):e.b/12.92,n=(t*.4124564+r*.3575761+o*.1804375)/.95047,a=(t*.2126729+r*.7151522+o*.072175)/1,s=(t*.0193339+r*.119192+o*.9503041)/1.08883,l=n>.008856?Math.pow(n,1/3):7.787*n+16/116,f=a>.008856?Math.pow(a,1/3):7.787*a+16/116,i=s>.008856?Math.pow(s,1/3):7.787*s+16/116;return{l:116*f-16,a:500*(l-f),b:200*(f-i)}}function Jo(e,t){let r=e.l,o=e.a,n=e.b,a=t.l,s=t.a,l=t.b,f=Math.sqrt(o*o+n*n),i=Math.sqrt(s*s+l*l),m=(f+i)/2,d=.5*(1-Math.sqrt(Math.pow(m,7)/(Math.pow(m,7)+Math.pow(25,7)))),c=(1+d)*o,u=(1+d)*s,y=Math.sqrt(c*c+n*n),g=Math.sqrt(u*u+l*l),b=Math.atan2(n,c)*180/Math.PI,I=Math.atan2(l,u)*180/Math.PI,$=a-r,N=g-y,k=I-b;k>180?k-=360:k<-180&&(k+=360);let C=2*Math.sqrt(y*g)*Math.sin(k*Math.PI/360),w=(r+a)/2,p=(y+g)/2,v=(b+I)/2;Math.abs(b-I)>180&&(v+=180);let x=1-.17*Math.cos((v-30)*Math.PI/180)+.24*Math.cos(2*v*Math.PI/180)+.32*Math.cos((3*v+6)*Math.PI/180)-.2*Math.cos((4*v-63)*Math.PI/180),A=30*Math.exp(-Math.pow((v-275)/25,2)),R=2*Math.sqrt(Math.pow(p,7)/(Math.pow(p,7)+Math.pow(25,7))),M=-Math.sin(2*A*Math.PI/180)*R,O=1+.015*Math.pow(w-50,2)/Math.sqrt(20+Math.pow(w-50,2)),D=1+.045*p,G=1+.015*p*x,P=1,U=1,Y=1;return Math.sqrt(Math.pow($/(P*O),2)+Math.pow(N/(U*D),2)+Math.pow(C/(Y*G),2)+M*(N/(U*D))*(C/(Y*G)))}function zt(e,t){if(t.length===0)return{match:null,deltaE:1/0};let r=Ut(e),o=t[0],n=Jo(r,Ut(t[0].valueRGB));for(let a=1;a<t.length;a++){let s=Ut(t[a].valueRGB),l=Jo(r,s);l<n&&(n=l,o=t[a])}return{match:o,deltaE:n}}var Qo=S(()=>{"use strict"});function en(e,t,r,o,n=0){if(n>5)return null;try{let a=e.valuesByMode[t];if(typeof a=="object"&&"r"in a&&"g"in a&&"b"in a)return{r:a.r,g:a.g,b:a.b};if(typeof a=="object"&&"type"in a&&a.type==="VARIABLE_ALIAS"){let s=a.id,l=r.find(f=>f.id===s);if(l){let f=o.find(i=>i.id===l.variableCollectionId);if(f){let i=f.modes[0].modeId;return en(l,i,r,o,n+1)}}}}catch(a){console.warn(`Error resolving variable ${e.name}`,a)}return null}function Wa(e){return e.type==="SOLID"?{r:e.color.r,g:e.color.g,b:e.color.b}:null}function Xa(){return H(this,null,function*(){if(!figma.variables)return[];try{let e=yield figma.variables.getLocalVariableCollectionsAsync(),t=yield figma.variables.getLocalVariablesAsync(),r=[];for(let o of t)if(o.resolvedType==="COLOR"){let n=e.find(a=>a.id===o.variableCollectionId);if(n){let a=n.modes[0].modeId,s=en(o,a,t,e);s&&r.push({name:o.name,valueRGB:s,variableId:o.id,collectionId:n.id})}else console.warn(`Variable ${o.name} has no collection`)}return console.log(`Found ${r.length} color variables`),r}catch(e){return console.error("Error fetching variables:",e),[]}})}function Ya(){return H(this,null,function*(){try{let e=yield figma.getLocalPaintStylesAsync(),t=[];for(let r of e)if(r.paints&&r.paints.length>0){let o=r.paints[0],n=Wa(o);n&&t.push({name:r.name,valueRGB:n,styleId:r.id})}return console.log(`Found ${t.length} color styles`),t}catch(e){return console.error("Error fetching styles:",e),[]}})}function jt(e,t,r=10){return H(this,null,function*(){let o=yield Xa(),n=yield Ya(),a=[];for(let s of e){let l,f,i=1/0,m=null;o.length>0&&(t==="variables"||!t)&&(m=zt(s.rawColor,o),m.match&&(l=m.match,i=m.deltaE));let d=null;n.length>0&&(t==="styles"||!t)&&(d=zt(s.rawColor,n),d.match&&(t==="styles"?(l=void 0,f=d.match,i=d.deltaE):t||(!l||d.deltaE<i)&&(l=void 0,f=d.match,i=d.deltaE)));let c=i<=r,y=!!(l||f)&&c;a.push({nodeId:s.nodeId,nodeName:s.nodeName,property:s.property,originalColor:s.rawColor,matchedVariable:y?l:void 0,matchedStyle:y?f:void 0,deltaE:i,isMatched:y,isCloseMatch:y})}return a})}var tn=S(()=>{"use strict";Qo()});function Za(e,t,r){return H(this,null,function*(){var o,n,a,s,l,f;try{if(!figma.variables)return console.error("Variables API not available"),!1;if("locked"in e&&e.locked)return console.error(`Node ${e.id} is locked`),!1;if(!(yield figma.variables.getVariableByIdAsync(r.variableId)))return console.error(`Variable not found: ${r.variableId} (${r.name})`),!1;let m={r:r.valueRGB.r,g:r.valueRGB.g,b:r.valueRGB.b};if(console.log(`Binding variable ${r.name} (${r.variableId}) to ${e.name} ${t}`),t==="fill"&&"fills"in e&&Array.isArray(e.fills)){"fillStyleId"in e&&(e.fillStyleId="");try{let d={type:"SOLID",color:m};try{let c={type:"SOLID",color:m,boundVariables:{color:r.variableId}};e.fills=[c],yield new Promise(y=>setTimeout(y,20));let u=yield figma.getNodeByIdAsync(e.id);if(u&&"fills"in u){let y=(o=u.fills)==null?void 0:o[0];if(((n=y==null?void 0:y.boundVariables)==null?void 0:n.color)===r.variableId)return!0}}catch(c){console.warn(`Variable binding failed for ${r.name}, falling back to color value`)}return e.fills=[{type:"SOLID",color:m}],!0}catch(d){return console.error("Error setting fills:",d.message),!1}}else if(t==="stroke"&&"strokes"in e&&Array.isArray(e.strokes)){"strokeStyleId"in e&&(e.strokeStyleId="");try{let d={type:"SOLID",color:m,boundVariables:{color:r.variableId}};e.strokes=[d],yield new Promise(u=>setTimeout(u,20));let c=yield figma.getNodeByIdAsync(e.id);if(c&&"strokes"in c){let u=(a=c.strokes)==null?void 0:a[0];if(((s=u==null?void 0:u.boundVariables)==null?void 0:s.color)===r.variableId)return!0}return e.strokes=[{type:"SOLID",color:m}],!0}catch(d){return console.error("Error setting strokes:",d.message),!1}}else if(t==="text"&&e.type==="TEXT"&&"fills"in e&&Array.isArray(e.fills)){"fillStyleId"in e&&(e.fillStyleId="");try{let d={type:"SOLID",color:m,boundVariables:{color:r.variableId}};e.fills=[d],yield new Promise(u=>setTimeout(u,20));let c=yield figma.getNodeByIdAsync(e.id);if(c&&"fills"in c){let u=(l=c.fills)==null?void 0:l[0];if(((f=u==null?void 0:u.boundVariables)==null?void 0:f.color)===r.variableId)return!0}return e.fills=[{type:"SOLID",color:m}],!0}catch(d){return console.error("Error setting text fills:",d.message),!1}}return console.error(`Node type ${e.type} doesn't support ${t} property`),!1}catch(i){return console.error(`Error applying variable to ${e.id} (${e.name}):`,i),!1}})}function Ka(e,t,r){return H(this,null,function*(){try{if("locked"in e&&e.locked)return console.error(`Node ${e.id} is locked`),!1;if(!figma.getStyleById(r.styleId))return console.error(`Style not found: ${r.styleId} (${r.name})`),!1;if(t==="fill"&&"fills"in e&&"fillStyleId"in e){if(Array.isArray(e.fills)&&e.fills.length>0){let n=e.fills[0];if(n.type==="SOLID"){let a=n;a.boundVariables&&Object.keys(a.boundVariables).length>0&&(e.fills=[{type:"SOLID",color:a.color,opacity:a.opacity!==void 0?a.opacity:1}])}}try{return e.fillStyleId=r.styleId,yield new Promise(n=>setTimeout(n,0)),e.fillStyleId===r.styleId}catch(n){return!1}}else if(t==="stroke"&&"strokes"in e&&"strokeStyleId"in e){if(Array.isArray(e.strokes)&&e.strokes.length>0){let n=e.strokes[0];if(n.type==="SOLID"){let a=n;a.boundVariables&&Object.keys(a.boundVariables).length>0&&(e.strokes=[{type:"SOLID",color:a.color,opacity:a.opacity!==void 0?a.opacity:1}])}}try{return e.strokeStyleId=r.styleId,yield new Promise(n=>setTimeout(n,0)),e.strokeStyleId===r.styleId}catch(n){return!1}}else if(t==="text"&&e.type==="TEXT"&&"fills"in e&&"fillStyleId"in e){if(Array.isArray(e.fills)&&e.fills.length>0){let n=e.fills[0];if(n.type==="SOLID"){let a=n;a.boundVariables&&Object.keys(a.boundVariables).length>0&&(e.fills=[{type:"SOLID",color:a.color,opacity:a.opacity!==void 0?a.opacity:1}])}}try{return e.fillStyleId=r.styleId,yield new Promise(n=>setTimeout(n,0)),e.fillStyleId===r.styleId}catch(n){return!1}}return!1}catch(o){return console.error(`Error applying style to ${e.id} (${e.name}):`,o),!1}})}function Ja(e,t){try{if(t==="fill"&&"fills"in e){let r=e.fills.length>0?e.fills[0]:void 0,o="fillStyleId"in e&&e.fillStyleId!==figma.mixed?e.fillStyleId:void 0;return{paint:r,styleId:o}}else if(t==="stroke"&&"strokes"in e){let r=e.strokes.length>0?e.strokes[0]:void 0,o="strokeStyleId"in e&&e.strokeStyleId!==figma.mixed?e.strokeStyleId:void 0;return{paint:r,styleId:o}}else if(t==="text"&&e.type==="TEXT"&&"fills"in e){let r=e.fills.length>0?e.fills[0]:void 0,o="fillStyleId"in e&&e.fillStyleId!==figma.mixed?e.fillStyleId:void 0;return{paint:r,styleId:o}}}catch(r){console.error(`Error storing original state for ${e.id}:`,r)}return null}function qt(e){return H(this,null,function*(){let t=[],r=[];for(let o of e){if(!o.isMatched){t.push({nodeId:o.nodeId,nodeName:o.nodeName,property:o.property,success:!1,error:"No match found"});continue}try{let n=yield figma.getNodeByIdAsync(o.nodeId);if(!n){t.push({nodeId:o.nodeId,nodeName:o.nodeName,property:o.property,success:!1,error:"Node not found"});continue}if("locked"in n&&n.locked){t.push({nodeId:o.nodeId,nodeName:o.nodeName,property:o.property,success:!1,error:"Node is locked"});continue}let a=n.parent,s=!1;for(;a;){if("locked"in a&&a.locked){s=!0;break}a=a.parent}if(s){t.push({nodeId:o.nodeId,nodeName:o.nodeName,property:o.property,success:!1,error:"Node is in a locked group"});continue}let l=Ja(n,o.property);l&&r.push({nodeId:o.nodeId,property:o.property,originalPaint:l.paint?JSON.parse(JSON.stringify(l.paint)):void 0,originalStyleId:l.styleId});let f=!1,i="Failed to apply";o.matchedVariable?(f=yield Za(n,o.property,o.matchedVariable),f||(i="Failed to apply variable")):o.matchedStyle?(f=yield Ka(n,o.property,o.matchedStyle),f||(i="Failed to apply style")):i="No variable or style to apply",t.push({nodeId:o.nodeId,nodeName:o.nodeName,property:o.property,success:f,error:f?void 0:i})}catch(n){t.push({nodeId:o.nodeId,nodeName:o.nodeName,property:o.property,success:!1,error:n.message||"Unknown error"})}}return{results:t,undoStates:r}})}function rn(e){return H(this,null,function*(){for(let t of e)try{let r=yield figma.getNodeByIdAsync(t.nodeId);if(!r)continue;t.property==="fill"&&"fills"in r?t.originalStyleId&&"fillStyleId"in r?r.fillStyleId=t.originalStyleId:t.originalPaint&&(r.fillStyleId="",r.fills=[t.originalPaint]):t.property==="stroke"&&"strokes"in r?t.originalStyleId&&"strokeStyleId"in r?r.strokeStyleId=t.originalStyleId:t.originalPaint&&(r.strokeStyleId="",r.strokes=[t.originalPaint]):t.property==="text"&&r.type==="TEXT"&&"fills"in r&&(t.originalStyleId&&"fillStyleId"in r?r.fillStyleId=t.originalStyleId:t.originalPaint&&(r.fillStyleId="",r.fills=[t.originalPaint]))}catch(r){console.error(`Error undoing replacement for ${t.nodeId}:`,r)}})}var on=S(()=>{"use strict"});function nn(e,t,r){return H(this,null,function*(){let o=Ft(e),n=yield jt(o,t,r),{results:a,undoStates:s}=yield qt(n),l=a.filter(i=>i.success).length,f=n.filter(i=>!i.isMatched&&i.deltaE===1/0).map(i=>({nodeId:i.nodeId,nodeName:i.nodeName,property:i.property,color:i.originalColor}));return{totalScanned:o.length,totalReplaced:l,matches:n,results:a,undoStates:s,unmatchedColors:f}})}function an(e,t,r){return H(this,null,function*(){let o=Zo(e),n=yield jt(o,t,r),{results:a,undoStates:s}=yield qt(n),l=a.filter(i=>i.success).length,f=n.filter(i=>!i.isMatched&&i.deltaE===1/0).map(i=>({nodeId:i.nodeId,nodeName:i.nodeName,property:i.property,color:i.originalColor}));return{totalScanned:o.length,totalReplaced:l,matches:n,results:a,undoStates:s,unmatchedColors:f}})}function sn(e){return H(this,null,function*(){yield rn(e)})}var ln=S(()=>{"use strict";Ko();tn();on()});var ni=cn(Se=>{Yo();ln();figma.showUI(__html__,{width:900,height:650,themeColors:!0});function X(e){let t=ne.default||ne,[r,o,n]=t(e).rgb();return{r:r/255,g:o/255,b:n/255}}function We(e,t,r){return(ne.default||ne)(e*255,t*255,r*255).hex()}var Qa={25:"lightest",50:"lighter",100:"light",200:"lighter-medium",300:"medium-light",400:"medium",500:"base",600:"medium-dark",700:"dark",800:"darker",900:"darkest",950:"darkest-plus",975:"darkest-max"};function ei(e,t,r,o){let n=e||"color";switch(r||"kebab-capital"){case"kebab-capital":return`${n.charAt(0).toUpperCase()+n.slice(1)}-${t}`;case"dot-lowercase":let s=Qa[t]||t.toString();return`${n.toLowerCase()}.${s}`;case"abbreviated":let l=n.charAt(0).toLowerCase(),f=t.toString().charAt(0);return`${l}${f} / ${t}`;case"custom":return(o||"{group}-{shade}").replace(/{group}/g,n).replace(/{shade}/g,t.toString());default:return t.toString()}}function ti(e,t){let r=e.toLowerCase();if(r==="primary"){if(t<=50)return"Primary Container";if(t<=100)return"On Primary Container";if(t<=200)return"Primary Fixed";if(t<=300)return"On Primary Fixed";if(t<=400)return"Primary Fixed Dim";if(t===500||t===600)return"Primary";if(t===700)return"On Primary";if(t>=800)return"Inverse Primary"}if(r==="secondary"){if(t<=50)return"Secondary Container";if(t<=100)return"On Secondary Container";if(t<=200)return"Secondary Fixed";if(t<=300)return"On Secondary Fixed";if(t<=400)return"Secondary Fixed Dim";if(t===500||t===600)return"Secondary";if(t===700)return"On Secondary";if(t>=800)return"Inverse Secondary"}if(r==="neutral"){if(t<=50)return"Surface";if(t<=100)return"On Surface";if(t<=200)return"Surface Container";if(t<=300)return"On Surface Container";if(t<=400)return"Surface Container High";if(t===500)return"Surface Container Highest";if(t===600)return"Inverse Surface";if(t===700)return"Inverse On Surface";if(t>=800)return"Outline";if(t>=900)return"Outline Variant"}if(r==="error"){if(t<=100)return"Error Container";if(t<=200)return"On Error Container";if(t===500)return"Error";if(t>=700)return"On Error"}if(r==="warning"){if(t<=100)return"Warning Container";if(t<=200)return"On Warning Container";if(t===500)return"Warning";if(t>=700)return"On Warning"}if(r==="success"){if(t<=100)return"Success Container";if(t<=200)return"On Success Container";if(t===500)return"Success";if(t>=700)return"On Success"}if(r==="info"){if(t<=100)return"Info Container";if(t<=200)return"On Info Container";if(t===500)return"Info";if(t>=700)return"On Info"}return t<=50?"Container":t<=100?"On Container":t<=200?"Fixed":t<=300?"On Fixed":t<=400?"Fixed Dim":t===500||t===600?e.charAt(0).toUpperCase()+e.slice(1):t===700?`On ${e.charAt(0).toUpperCase()+e.slice(1)}`:t>=800?`Inverse ${e.charAt(0).toUpperCase()+e.slice(1)}`:`Shade ${t}`}function ri(e){return{50:950,100:900,200:800,300:700,400:600,500:500,600:400,700:300,800:200,900:100,950:50}[e]||e}function oi(e,t,r,o){if(o==="light"){let m=[50,100,200,300,400],d=m.indexOf(r);if(d>0){let y=m[d-1],g=e[t],b=g==null?void 0:g.find(I=>I.shade===y);if(b)return b.value}let c=e[t],u=c==null?void 0:c.find(y=>y.shade===r);return(u==null?void 0:u.value)||null}let n=ri(r),a=e[t],s=a==null?void 0:a.find(m=>m.shade===n);if(!s)return console.warn(`Could not find inverted shade ${n} for base shade ${r} in ${t}`),null;let l=s.value;if(!ne.valid(l))return l;let f=ne(l),i=f;switch(o){case"dark":i=f.saturate(.1);break;case"dim":i=f.desaturate(.2);break;case"amoled":i=f.darken(.1).saturate(.15);break;default:break}return i.hex()}figma.ui.onmessage=e=>H(null,null,function*(){var o,n,a,s,l,f;if(e.type==="create-variables-from-colors"&&(console.log("=== MESSAGE RECEIVED IN PLUGIN CODE ==="),console.log("Message type:",e.type),console.log("Message data:",{colorsCount:(o=e.colors)==null?void 0:o.length,collectionId:e.collectionId,createNewCollection:e.createNewCollection})),e.type==="get-target-options"){if(e.targetType==="variables")if(figma.variables)try{let m=(yield figma.variables.getLocalVariableCollectionsAsync()).map(d=>({label:d.name,value:d.id}));figma.ui.postMessage({type:"target-options-response",targetType:"variables",options:m})}catch(i){figma.notify("Error fetching collections")}else figma.ui.postMessage({type:"target-options-response",targetType:"variables",options:[]});else if(e.targetType==="styles")try{let i=yield figma.getLocalPaintStylesAsync(),m=new Set;i.forEach(c=>{if(c.name.includes("/")){let y=c.name.split("/")[0];m.add(y)}});let d=Array.from(m).map(c=>({label:c,value:c}));d.unshift({label:"(Root)",value:""}),figma.ui.postMessage({type:"target-options-response",targetType:"styles",options:d})}catch(i){figma.notify("Error fetching styles")}}if(e.type==="create-color-styles"){let{palettes:i,action:m,targetId:d}=e,c=0;try{let u=yield figma.getLocalPaintStylesAsync(),y=new Map(u.map(b=>[b.name,b])),g="";m==="create"?g=`ProColors (${new Date().toLocaleString("en-GB",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"})})/`:m==="update"&&(g=d?d.endsWith("/")?d:`${d}/`:"",d===""&&(g=""));for(let[b,I]of Object.entries(i))for(let $ of I){let N=`${b}/${$.shade}`,k=g+N,C;C=y.get(k),C||(C=figma.createPaintStyle(),C.name=k,y.set(k,C));let{r:w,g:p,b:v}=X($.value);C.paints=[{type:"SOLID",color:{r:w,g:p,b:v}}],C.description=`Generated by ProColors. Value: ${$.value}`,c++}figma.notify(`Success! ${m==="create"?"Created new":"Updated"} ${c} color styles.`)}catch(u){console.error("ProColors Error:",u),figma.notify(`Error creating styles: ${u.message}`)}}if(e.type==="create-color-variables"){if(!figma.variables){figma.notify("Error: Variables API is not available in this file.");return}let{palettes:i,action:m,targetId:d,variableType:c,collectionId:u,brandName:y,namingConvention:g,customNamingPattern:b}=e,I=0,$=0;try{let N=yield figma.variables.getLocalVariableCollectionsAsync(),k,C,w=y&&y.trim()?`${y.trim()} Token`:"ProColors Token";if(m==="create")if(c==="collection"){let M=new Date().toLocaleString("en-GB",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"});k=figma.variables.createVariableCollection(`${w} (${M})`)}else if(c==="alias"||c==="component"){if(!u){figma.notify("Error: No collection selected. Please select a collection to add variables to.");return}if(k=N.find(M=>M.id===u),!k){figma.notify("Error: Selected collection not found.");return}}else{let M=new Date().toLocaleString("en-GB",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"});k=figma.variables.createVariableCollection(`${w} (${M})`)}else if(m==="update"&&(d&&(k=N.find(M=>M.id===d)),k||(k=N.find(M=>M.name===w)),!k)){let M=new Date().toLocaleString("en-GB",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"});k=figma.variables.createVariableCollection(`${w} (${M})`)}if(!k)throw new Error("Could not determine variable collection.");let p=k.modes[0].modeId,v=yield figma.variables.getLocalVariablesAsync(),x=v.filter(M=>M.variableCollectionId===k.id),A=new Map(x.map(M=>[M.name,M])),R=new Map;if(c==="alias"||c==="component"){let M=v.filter(O=>O.variableCollectionId===k.id);R=new Map(M.map(O=>[O.name,O]))}for(let[M,O]of Object.entries(i))for(let D of O){let G;if(c==="component"){let P=ti(M,D.shade);G=`Component/${M}/${P}`}else if(c==="alias"){let P=ei(M,D.shade,g,b);G=`Alias/${M}/${P}`}else G=`Base Tokens/${M}/${D.shade}`;try{let P=A.get(G);if(c==="alias"){let U=`Base Tokens/${M}/${D.shade}`,Y=R.get(U);if(Y)P||(P=figma.variables.createVariable(G,k,"COLOR"),A.set(G,P)),P.setValueForMode(p,{type:"VARIABLE_ALIAS",id:Y.id});else{console.warn(`Source variable ${U} not found, creating new variable instead.`);let{r:K,g:ae,b:ye}=X(D.value),ke={r:K,g:ae,b:ye,a:1};P||(P=figma.variables.createVariable(G,k,"COLOR"),A.set(G,P)),P.setValueForMode(p,ke)}}else if(c==="component"){let U=`Base Tokens/${M}/${D.shade}`,Y=R.get(U);if(Y)P||(P=figma.variables.createVariable(G,k,"COLOR"),A.set(G,P)),P.setValueForMode(p,{type:"VARIABLE_ALIAS",id:Y.id});else{console.warn(`Source variable ${U} not found in collection. Creating new variable instead.`);let{r:K,g:ae,b:ye}=X(D.value),ke={r:K,g:ae,b:ye,a:1};P||(P=figma.variables.createVariable(G,k,"COLOR"),A.set(G,P)),P.setValueForMode(p,ke)}}else{let{r:U,g:Y,b:K}=X(D.value),ae={r:U,g:Y,b:K,a:1};P||(P=figma.variables.createVariable(G,k,"COLOR"),A.set(G,P)),P.setValueForMode(p,ae)}I++}catch(P){console.error(`Failed to create variable ${G}:`,P),$++}}if($>0)figma.notify(`Processed ${I} variables. Failed: ${$}. Check console.`);else{let M=c==="alias"?"alias":c==="component"?"component token":"";figma.notify(`Success! ${m==="create"?"Created new":"Updated"} ${I} ${M} variables in "${k.name}".`)}}catch(N){console.error("Magic Color Error:",N),figma.notify(`Error: ${N.message||"Unknown error"}`)}}if(e.type==="get-collections-for-theme"){if(!figma.variables){figma.ui.postMessage({type:"collections-response",collections:[]});return}try{let m=(yield figma.variables.getLocalVariableCollectionsAsync()).map(d=>({id:d.id,name:d.name}));figma.ui.postMessage({type:"collections-response",collections:m})}catch(i){console.error("Error fetching collections:",i),figma.ui.postMessage({type:"collections-response",collections:[]})}}if(e.type==="create-theme-variable"){if(!figma.variables){figma.notify("Error: Variables API is not available in this file.");return}let{theme:i,palettes:m,collectionId:d}=e;if(console.log("Creating theme variables for theme:",i,"collectionId:",d),!m||Object.keys(m).length===0){figma.notify("Error: No palettes provided.");return}if(!d){figma.notify("Error: No collection selected.");return}let c=0,u=0;try{let g=(yield figma.variables.getLocalVariableCollectionsAsync()).find(k=>k.id===d);if(!g){figma.notify("Error: Collection not found.");return}console.log("Available modes before:",g.modes.map(k=>({name:k.name,id:k.modeId}))),console.log("Looking for theme:",i);let b=(n=g.modes.find(k=>{let C=k.name.toLowerCase().trim(),w=i.toLowerCase().trim(),p=C===w;return console.log(`Comparing mode "${k.name}" (${C}) with theme "${i}" (${w}): ${p}`),p}))==null?void 0:n.modeId;if(b){let k=g.modes.find(C=>C.modeId===b);console.log(`Using existing mode "${k==null?void 0:k.name}" (ID: ${b}) for theme "${i}"`)}else try{console.log(`Creating new mode: ${i}`),b=g.addMode(i).modeId,console.log(`Created mode "${i}" with ID: ${b}`);let w=(yield figma.variables.getLocalVariableCollectionsAsync()).find(p=>p.id===d);w&&console.log("Updated modes after creation:",w.modes.map(p=>({name:p.name,id:p.modeId})))}catch(k){console.error("Error creating mode:",k),figma.notify(`Error: Could not create new mode. ${k.message}`);return}console.log(`Final modeId for theme "${i}": ${b}`);let $=(yield figma.variables.getLocalVariablesAsync()).filter(k=>k.variableCollectionId===g.id),N=new Map($.map(k=>[k.name,k]));for(let[k,C]of Object.entries(m)){if(!Array.isArray(C)){console.warn(`Skipping ${k}: not an array`,C);continue}for(let w of C){if(!w||!w.shade||!w.value){console.warn(`Skipping invalid token in ${k}:`,w);continue}let p=`${k}/${w.shade}`;try{let v=oi(m,k,w.shade,i);if(!v){console.warn(`Could not get theme color for ${p} in theme ${i}`);continue}console.log(`Variable ${p}: Base shade ${w.shade} color ${w.value} -> Theme ${i} color ${v}`);let{r:x,g:A,b:R}=X(v),M={r:x,g:A,b:R,a:1},O=N.get(p);O||(O=figma.variables.createVariable(p,g,"COLOR"),N.set(p,O),console.log(`Created new variable: ${p}`)),console.log(`Setting value for variable ${p} in mode ${b} (theme: ${i}):`,{baseShade:w.shade,baseColor:w.value,themeColor:v,rgb:M,modeName:(a=g.modes.find(G=>G.modeId===b))==null?void 0:a.name}),O.setValueForMode(b,M);let D=O.valuesByMode[b];console.log(`Verified value for ${p} in mode ${b} (${(s=g.modes.find(G=>G.modeId===b))==null?void 0:s.name}):`,D),console.log(`All values for ${p} across modes:`,Object.keys(O.valuesByMode).map(G=>{var P;return{modeId:G,modeName:(P=g.modes.find(U=>U.modeId===G))==null?void 0:P.name,value:O.valuesByMode[G]}})),c++}catch(v){console.error(`Failed to create variable ${p}:`,v),u++}}}u>0?figma.notify(`Created ${c} theme variables. Failed: ${u}. Check console.`):figma.notify(`Success! Added "${i}" theme mode with ${c} variables to "${g.name}".`)}catch(y){console.error("Magic Color Error creating theme variables:",y),figma.notify(`Error: ${y.message||"Unknown error"}`)}}if(e.type==="create-gradient-style"){let{gradient:i}=e;try{let m=`gradient/${i.type}/${i.name.toLowerCase().replace(/\s+/g,"-")}`,c=(yield figma.getLocalPaintStylesAsync()).find(g=>g.name===m);c||(c=figma.createPaintStyle(),c.name=m);let u=i.stops.map(g=>{let{r:b,g:I,b:$}=X(g.color),k=(ne.default||ne)(g.color).alpha();return{color:{r:b,g:I,b:$,a:k},position:g.position/100}}),y=[[1,0,0],[0,1,0]];if(i.type==="linear"){let g=(i.angle||180)*(Math.PI/180),b=Math.cos(g),I=Math.sin(g);y=[[b,I,0],[-I,b,0]]}c.paints=[{type:i.type==="linear"?"GRADIENT_LINEAR":i.type==="radial"?"GRADIENT_RADIAL":"GRADIENT_ANGULAR",gradientStops:u,gradientTransform:y}],figma.notify(`Created gradient style: ${m}`)}catch(m){console.error(m),figma.notify(`Error creating gradient: ${m.message}`)}}if(e.type==="create-gradient-variables"){if(!figma.variables){figma.notify("Error: Variables API not available.");return}let{gradient:i}=e,m=`gradient/${i.type}/${i.name.toLowerCase().replace(/\s+/g,"-")}`;try{let c=(yield figma.variables.getLocalVariableCollectionsAsync()).find(g=>g.name==="ProColorsGradients");c||(c=figma.variables.createVariableCollection("ProColorsGradients"));let u=c.modes[0].modeId,y=0;for(let g=0;g<i.stops.length;g++){let b=i.stops[g],I=`${m}/stop-${g}-${b.position}`,N=(yield figma.variables.getLocalVariablesAsync()).find(p=>p.name===I&&p.variableCollectionId===c.id);N||(N=figma.variables.createVariable(I,c,"COLOR"));let{r:k,g:C,b:w}=X(b.color);N.setValueForMode(u,{r:k,g:C,b:w,a:1}),y++}figma.notify(`Created ${y} variables for gradient stops.`)}catch(d){console.error(d),figma.notify(`Error creating variables: ${d.message}`)}}if(e.type==="get-export-options")try{let i=yield figma.getLocalPaintStylesAsync(),m=figma.variables?yield figma.variables.getLocalVariableCollectionsAsync():[],d=new Set;i.forEach(c=>{if(c.name.includes("/")){let u=c.name.split("/");d.add(u[0])}else d.add("(Root)")}),figma.ui.postMessage({type:"export-options-response",collections:m.map(c=>({id:c.id,name:c.name})),styleGroups:Array.from(d)})}catch(i){console.error(i),figma.ui.postMessage({type:"export-options-response",collections:[],styleGroups:[]})}if(e.type==="export-all-data")try{let{selectedCollectionIds:i=[],selectedStyleGroups:m=[]}=e,d=yield figma.getLocalPaintStylesAsync(),c=yield figma.variables.getLocalVariablesAsync(),u=yield figma.variables.getLocalVariableCollectionsAsync(),y=c;i.length>0&&(y=c.filter(I=>i.includes(I.variableCollectionId)));let g=d;m.length>0&&(g=d.filter(I=>{if(I.name.includes("/")){let $=I.name.split("/")[0];return m.includes($)}else return m.includes("(Root)")}));let b={variables:y.map(I=>{let $=u.find(w=>w.id===I.variableCollectionId),N=$==null?void 0:$.modes[0].modeId,k=N?I.valuesByMode[N]:null,C=k;return k&&typeof k=="object"&&"r"in k&&(C=We(k.r,k.g,k.b)),{name:I.name,type:I.resolvedType,collection:($==null?void 0:$.name)||"Unknown",value:C}}),styles:g.map(I=>{var N;let $=null;if(I.paints.length>0&&I.paints[0].type==="SOLID"){let{r:k,g:C,b:w}=I.paints[0].color;$=We(k,C,w)}return{name:I.name,description:I.description,type:((N=I.paints[0])==null?void 0:N.type)||"SOLID",value:$}})};figma.ui.postMessage({type:"export-data-success",data:b,fileName:figma.root.name})}catch(i){console.error(i),figma.notify("Export failed: "+i.message)}if(e.type==="import-data"){let{data:i}=e;try{let m=0,d=0;if(i.variables&&i.variables.length>0&&figma.variables){let u=(yield figma.variables.getLocalVariableCollectionsAsync()).find(b=>b.name==="ProColors Imported");u||(u=figma.variables.createVariableCollection("ProColors Imported"));let y=u.modes[0].modeId,g=yield figma.variables.getLocalVariablesAsync();for(let b of i.variables)if(b.type==="COLOR"&&b.value){let I=g.find($=>$.name===b.name&&$.variableCollectionId===u.id);I||(I=figma.variables.createVariable(b.name,u,"COLOR"));try{let{r:$,g:N,b:k}=X(b.value);I.setValueForMode(y,{r:$,g:N,b:k,a:1}),m++}catch($){}}}if(i.styles&&i.styles.length>0){let c=yield figma.getLocalPaintStylesAsync();for(let u of i.styles)if(u.type==="SOLID"&&u.value){let y=c.find($=>$.name===u.name);y||(y=figma.createPaintStyle(),y.name=u.name);let{r:g,g:b,b:I}=X(u.value);y.paints=[{type:"SOLID",color:{r:g,g:b,b:I}}],y.description=u.description||"Imported by ProColors",d++}}figma.notify(`Imported: ${m} variables, ${d} styles.`),figma.ui.postMessage({type:"import-data-finished"})}catch(m){console.error(m),figma.notify("Import failed: "+m.message),figma.ui.postMessage({type:"import-data-finished"})}}if(e.type==="replace-colors"){let u=function(y){if("fills"in y,"children"in y)for(let g of y.children)u(g);c++};var t=u;let{scope:i,target:m}=e,d=[];i==="selection"?d=[...figma.currentPage.selection]:d=[...figma.currentPage.children];let c=0;d.forEach(u),figma.notify(`Scanned ${c} nodes. Color replacement requires active palette mapping (Not fully implemented in MVP).`)}if(e.type==="link-colors")try{let{scope:i,preference:m,threshold:d}=e,c=d!==void 0?d:10;if(i==="selection"||!i){let u=figma.currentPage.selection;if(u.length===0){figma.ui.postMessage({type:"link-colors-error",error:"Please select a frame or component to begin."});return}let y=yield nn(u,m,c);if(console.log(`Linking complete: ${y.totalReplaced} of ${y.totalScanned} colors replaced`),y.totalReplaced>0)figma.notify(`\u2713 Successfully linked ${y.totalReplaced} colors to ${m||"variables/styles"}`);else if(y.totalScanned>0){let g=y.results.filter(k=>!k.success),b={};g.forEach(k=>{let C=k.error||"Unknown error";b[C]=(b[C]||0)+1});let I=Object.entries(b).sort((k,C)=>C[1]-k[1])[0],$=I?I[0]:"Unknown",N=`\u26A0 Linked 0 colors. Issue: ${$}`;$.includes("Failed to apply variable")&&(N+=". Make sure variables are local (not remote) and you have edit access."),figma.notify(N),console.error("Failed replacements:",g.slice(0,10)),console.error("Error breakdown:",b)}else figma.notify("No unlinked colors found in selection");figma.ui.postMessage({type:"link-colors-result",result:y})}else if(i==="page"){let u=d!==void 0?d:10,y=yield an(figma.currentPage,m,u);figma.ui.postMessage({type:"link-colors-result",result:y})}}catch(i){console.error("Error linking colors:",i),figma.ui.postMessage({type:"link-colors-error",error:i.message||"Unknown error occurred"})}if(e.type==="undo-linking")try{let{undoStates:i}=e;yield sn(i),figma.notify("Changes undone successfully")}catch(i){console.error("Error undoing linking:",i),figma.notify(`Error undoing: ${i.message||"Unknown error"}`)}if(e.type==="add-palette-to-canvas"){let{palettes:i}=e;try{yield figma.loadFontAsync({family:"Inter",style:"Regular"}),yield figma.loadFontAsync({family:"Inter",style:"Bold"});let m=80,d=12,c=16,u=figma.createFrame();u.name="ProColorTokens",u.fills=[{type:"SOLID",color:{r:.97,g:.97,b:.98}}],u.layoutMode="VERTICAL",u.primaryAxisSizingMode="AUTO",u.counterAxisSizingMode="AUTO",u.paddingLeft=24,u.paddingRight=24,u.paddingTop=24,u.paddingBottom=24,u.itemSpacing=16,u.counterAxisAlignItems="MIN";let y=figma.createText();y.characters="ProColorTokens",y.fontSize=24,y.fontName={family:"Inter",style:"Bold"},y.resize(400,32),u.appendChild(y);let g=figma.createText();g.characters="Color palette generate with ProColors plugin.",g.fontSize=14,g.fontName={family:"Inter",style:"Regular"},g.resize(400,20),u.appendChild(g);let b=figma.createFrame();b.name="Color Grid",b.fills=[],b.layoutMode="VERTICAL",b.primaryAxisSizingMode="AUTO",b.counterAxisSizingMode="AUTO",b.paddingLeft=0,b.paddingRight=0,b.paddingTop=0,b.paddingBottom=0,b.itemSpacing=c,b.counterAxisAlignItems="MIN",u.appendChild(b);let I=Object.entries(i).sort(([N],[k])=>{let C=["primary","secondary","neutral","success","warning","error","info"],w=C.indexOf(N.toLowerCase()),p=C.indexOf(k.toLowerCase());return w===-1&&p===-1?N.localeCompare(k):w===-1?1:p===-1?-1:w-p});for(let[N,k]of I){let C=figma.createFrame();C.name=`${N} Group`,C.fills=[],C.layoutMode="VERTICAL",C.primaryAxisSizingMode="AUTO",C.counterAxisSizingMode="AUTO",C.paddingLeft=0,C.paddingRight=0,C.paddingTop=0,C.paddingBottom=0,C.itemSpacing=12,C.counterAxisAlignItems="MIN",b.appendChild(C);try{let v=figma.createText(),x=N.charAt(0).toUpperCase()+N.slice(1);v.characters=x,v.fontSize=16,v.fontName={family:"Inter",style:"Bold"},v.resize(200,22),v.fills=[{type:"SOLID",color:{r:.12,g:.12,b:.12}}],C.appendChild(v)}catch(v){}let w=figma.createFrame();w.name=N,w.fills=[],w.layoutMode="HORIZONTAL",w.primaryAxisSizingMode="AUTO",w.counterAxisSizingMode="AUTO",w.paddingLeft=0,w.paddingRight=0,w.paddingTop=0,w.paddingBottom=0,w.itemSpacing=d,w.counterAxisAlignItems="CENTER",C.appendChild(w);let p=[...k].sort((v,x)=>{let A=typeof v.shade=="number"?v.shade:parseInt(v.shade.toString()),R=typeof x.shade=="number"?x.shade:parseInt(x.shade.toString());return A-R});for(let v of p){let x=figma.createFrame();x.name=`${N}-${v.shade}`,x.fills=[],x.layoutMode="VERTICAL",x.primaryAxisSizingMode="FIXED",x.counterAxisSizingMode="FIXED",x.layoutGrow=0,x.paddingLeft=0,x.paddingRight=0,x.paddingTop=0,x.paddingBottom=0,x.itemSpacing=6,x.counterAxisAlignItems="CENTER",x.resize(m,m+24);let A=figma.createRectangle(),{r:R,g:M,b:O}=X(v.value);A.fills=[{type:"SOLID",color:{r:R,g:M,b:O}}],A.resize(m,m),A.cornerRadius=8,x.appendChild(A);try{let D=figma.createText();D.characters=`${N}-${v.shade}`,D.fontSize=11,D.fontName={family:"Inter",style:"Regular"},D.resize(m,18),D.textAlignHorizontal="CENTER",x.appendChild(D)}catch(D){}w.appendChild(x)}}figma.currentPage.appendChild(u),figma.currentPage.selection=[u],figma.viewport.scrollAndZoomIntoView([u]);let $=Object.values(i).reduce((N,k)=>N+k.length,0);figma.notify(`Added color palette with ${Object.keys(i).length} groups (${$} swatches) to canvas`)}catch(m){console.error("Error adding palette to canvas:",m),figma.notify(`Error: ${m.message||"Failed to add palette to canvas"}`)}}if(e.type==="notify"&&figma.notify(e.message),e.type==="fetch-webpage"){let{url:i}=e;try{let m=i.trim();!m.startsWith("http://")&&!m.startsWith("https://")&&(m="https://"+m);let d=yield fetch(m,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"}});if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);let c=yield d.text();figma.ui.postMessage({type:"webpage-html-response",html:c,url:m})}catch(m){console.error("Error fetching webpage:",m),figma.ui.postMessage({type:"webpage-html-response",error:m.message||"Failed to fetch webpage"})}}if(e.type==="explore-add-variables"){if(!figma.variables){figma.notify("Error: Variables API not available.");return}let{palette:i}=e;try{let d=(yield figma.variables.getLocalVariableCollectionsAsync()).find(g=>g.name==="Explore Palettes");d||(d=figma.variables.createVariableCollection("Explore Palettes"));let c=d.modes[0].modeId,u=yield figma.variables.getLocalVariablesAsync(),y=0;for(let g=0;g<i.colors.length;g++){let b=i.colors[g],I=`${i.name}-${g+1}`,$=u.find(w=>w.name===I&&w.variableCollectionId===d.id);$||($=figma.variables.createVariable(I,d,"COLOR"));let{r:N,g:k,b:C}=X(b);$.setValueForMode(c,{r:N,g:k,b:C,a:1}),y++}figma.notify(`Added ${y} variables to "Explore Palettes" collection.`)}catch(m){console.error(m),figma.notify(`Error creating variables: ${m.message}`)}}if(e.type==="explore-add-styles"){let{palette:i}=e;try{let m=yield figma.getLocalPaintStylesAsync(),d=0;for(let c=0;c<i.colors.length;c++){let u=i.colors[c],y=`${i.name}/${c+1}`,g=`${i.name}-${c+1}`,b=m.find(k=>k.name===g);b||(b=figma.createPaintStyle(),b.name=g);let{r:I,g:$,b:N}=X(u);b.paints=[{type:"SOLID",color:{r:I,g:$,b:N}}],d++}figma.notify(`Created ${d} color styles.`)}catch(m){console.error(m),figma.notify(`Error creating styles: ${m.message}`)}}if(e.type==="save-settings")try{let i=e.settings;console.log("Saving settings to clientStorage:",i),yield figma.clientStorage.setAsync("procolors-settings",i),console.log("Settings saved successfully to clientStorage"),figma.ui.postMessage({type:"settings-saved",success:!0})}catch(i){console.error("Error saving settings:",i),figma.ui.postMessage({type:"settings-saved",success:!1,error:i.message})}if(e.type==="get-settings")try{let i=yield figma.clientStorage.getAsync("procolors-settings");figma.ui.postMessage({type:"settings-loaded",settings:i||null})}catch(i){console.error("Error loading settings:",i),figma.ui.postMessage({type:"settings-loaded",settings:null,error:i.message})}if(e.type==="clear-settings")try{yield figma.clientStorage.setAsync("procolors-settings",null),figma.ui.postMessage({type:"settings-cleared",success:!0})}catch(i){console.error("Error clearing settings:",i),figma.ui.postMessage({type:"settings-cleared",success:!1,error:i.message})}if(e.type==="save-brands")try{let i=e.brands;console.log("Saving brands to clientStorage:",i),yield figma.clientStorage.setAsync("procolors-brands",i),console.log("Brands saved successfully to clientStorage"),figma.ui.postMessage({type:"brands-saved",success:!0})}catch(i){console.error("Error saving brands:",i),figma.ui.postMessage({type:"brands-saved",success:!1,error:i.message})}if(e.type==="get-brands")try{let i=yield figma.clientStorage.getAsync("procolors-brands");figma.ui.postMessage({type:"brands-loaded",brands:i||null})}catch(i){console.error("Error loading brands:",i),figma.ui.postMessage({type:"brands-loaded",brands:null,error:i.message})}if(e.type==="save-active-brand-id")try{let i=e.brandId;console.log("Saving active brand ID to clientStorage:",i),yield figma.clientStorage.setAsync("procolors-active-brand-id",i),console.log("Active brand ID saved successfully to clientStorage"),figma.ui.postMessage({type:"active-brand-id-saved",success:!0})}catch(i){console.error("Error saving active brand ID:",i),figma.ui.postMessage({type:"active-brand-id-saved",success:!1,error:i.message})}if(e.type==="get-active-brand-id")try{let i=yield figma.clientStorage.getAsync("procolors-active-brand-id");figma.ui.postMessage({type:"active-brand-id-loaded",brandId:i||null})}catch(i){console.error("Error loading active brand ID:",i),figma.ui.postMessage({type:"active-brand-id-loaded",brandId:null,error:i.message})}if(e.type==="scan-colors"){let{scope:i,threshold:m}=e;try{let u=function(g,b=""){let I=b?`${b}/${g.name}`:g.name;"fills"in g&&Array.isArray(g.fills)&&g.fills.forEach($=>{if($.type==="SOLID"){let N=We($.color.r,$.color.g,$.color.b),k=c.get(N);k?(k.count++,k.locations.includes(I)||k.locations.push(I)):c.set(N,{count:1,locations:[I]})}}),"strokes"in g&&Array.isArray(g.strokes)&&g.strokes.forEach($=>{if($.type==="SOLID"){let N=We($.color.r,$.color.g,$.color.b),k=c.get(N);k?(k.count++,k.locations.includes(I)||k.locations.push(I)):c.set(N,{count:1,locations:[I]})}}),"children"in g&&g.children.forEach($=>{u($,I)})};var r=u;let d=[];if(i==="selection"){if(d=[...figma.currentPage.selection],d.length===0){figma.ui.postMessage({type:"scan-colors-result",colors:[],error:"No selection found. Please select at least one element."});return}}else if(i==="page"){if(d=[...figma.currentPage.children],d.length===0){figma.ui.postMessage({type:"scan-colors-result",colors:[],error:"Current page is empty."});return}}else if(i==="file"&&(console.log("Loading all pages..."),yield figma.loadAllPagesAsync(),console.log("All pages loaded"),figma.root.children.forEach(g=>{g.type==="PAGE"&&d.push(...g.children)}),d.length===0)){figma.ui.postMessage({type:"scan-colors-result",colors:[],error:"File is empty."});return}let c=new Map;d.forEach(g=>u(g));let y=Array.from(c.entries()).map(([g,b])=>({color:g,count:b.count,locations:b.locations.slice(0,10)}));console.log("Sending scan-colors-result:",{colorsCount:y.length}),figma.ui.postMessage({type:"scan-colors-result",colors:y})}catch(d){console.error("Error scanning colors:",d),figma.ui.postMessage({type:"scan-colors-result",colors:[],error:d.message})}}if(e.type==="create-semantic-tokens"){if(console.log("=== CREATE SEMANTIC TOKENS HANDLER ==="),console.log("Semantic tokens count:",(l=e.semanticTokens)==null?void 0:l.length),console.log("Collection ID:",e.collectionId),!figma.variables){console.error("Variables API not available"),figma.notify("Error: Variables API is not available.");return}let{semanticTokens:i,baseTokens:m,collectionId:d}=e,c=0,u=0;try{let y=yield figma.variables.getLocalVariableCollectionsAsync();console.log("Available collections:",y.map(C=>({id:C.id,name:C.name})));let g=y.find(C=>C.id===d);if(!g){console.error("Collection not found:",d),figma.notify("Error: Collection not found.");return}console.log("Using collection:",g.name);let b=g.modes[0].modeId,$=(yield figma.variables.getLocalVariablesAsync()).filter(C=>C.variableCollectionId===g.id),N=new Map($.map(C=>[C.name,C])),k=new Map;$.forEach(C=>{C.name.startsWith("Base Tokens/")&&k.set(C.name,C)});for(let C of i)try{let w=C.name.replace(/\./g,"/");console.log(`Creating token: "${C.name}" -> "${w}"`);let p=N.get(w);if(p?console.log(`Variable already exists: ${w}`):(p=figma.variables.createVariable(w,g,"COLOR"),N.set(w,p),console.log(`\u2713 Created variable: ${w}`)),C.aliasTo){let v=k.get(C.aliasTo);if(v)p.setValueForMode(b,{type:"VARIABLE_ALIAS",id:v.id}),console.log(`\u2713 Set alias for ${w} to ${C.aliasTo}`);else if(console.warn(`Alias source not found: ${C.aliasTo}, using direct value`),C.value){let{r:x,g:A,b:R}=X(C.value);p.setValueForMode(b,{r:x,g:A,b:R,a:1})}}else if(C.value){let{r:v,g:x,b:A}=X(C.value);p.setValueForMode(b,{r:v,g:x,b:A,a:1}),console.log(`\u2713 Set direct value for ${w}: ${C.value}`)}c++}catch(w){console.error(`Failed to create semantic token ${C.name}:`,w),console.error("Error details:",w.message,w.stack),u++}console.log(`Completed: ${c} created, ${u} failed`),u>0?figma.notify(`Created ${c} semantic tokens. Failed: ${u}.`):figma.notify(`Success! Created ${c} semantic tokens.`)}catch(y){console.error("Error creating semantic tokens:",y),figma.notify(`Error: ${y.message||"Unknown error"}`)}}if(e.type==="create-token-snapshot"){let{tokens:i,semanticTokens:m,name:d,description:c}=e;try{let u={id:`snapshot-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now(),name:d||`Snapshot ${new Date().toLocaleString()}`,description:c,tokens:i,semanticTokens:m},y=(yield figma.clientStorage.getAsync("token-snapshots"))||[];y.push(u),yield figma.clientStorage.setAsync("token-snapshots",y),figma.ui.postMessage({type:"token-snapshot-created",snapshot:u}),figma.notify(`Snapshot "${u.name}" created successfully.`)}catch(u){console.error("Error creating snapshot:",u),figma.ui.postMessage({type:"token-snapshot-error",error:u.message})}}if(e.type==="get-token-snapshots")try{let i=(yield figma.clientStorage.getAsync("token-snapshots"))||[];figma.ui.postMessage({type:"token-snapshots-loaded",snapshots:i})}catch(i){console.error("Error loading snapshots:",i),figma.ui.postMessage({type:"token-snapshots-loaded",snapshots:[]})}if(e.type==="create-variables-from-colors"){console.log("=== CREATE VARIABLES HANDLER CALLED ==="),console.log("Received create-variables-from-colors request:",{colorsCount:(f=e.colors)==null?void 0:f.length,collectionId:e.collectionId,createNewCollection:e.createNewCollection,hasColors:!!e.colors}),H(null,null,function*(){let i=!1,m=c=>{if(i){console.warn("Response already sent, ignoring duplicate");return}i=!0,console.log("Sending response:",c),figma.ui.postMessage(c)},d=setTimeout(()=>{i||(console.error("Handler timeout - sending error response"),m({type:"create-variables-from-colors-result",success:!1,error:"Handler timeout - operation took too long"}))},25e3);try{if(!figma.variables){console.error("Variables API not available"),m({type:"create-variables-from-colors-result",success:!1,error:"Variables API is not available in this file."});return}if(!e.colors||!Array.isArray(e.colors)||e.colors.length===0){console.error("No colors provided"),m({type:"create-variables-from-colors-result",success:!1,error:"No colors provided to create variables."});return}let{colors:c,collectionId:u,createNewCollection:y}=e,g=0,b=0;console.log("Getting collections...");let I=yield figma.variables.getLocalVariableCollectionsAsync();console.log("Found collections:",I.length);let $;if(console.log("Collection decision:",{createNewCollection:y,collectionId:u,hasCollectionId:!!u}),y||!u||u===null){let v=new Date().toLocaleString("en-GB",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"});console.log("Creating new collection...");try{$=figma.variables.createVariableCollection(`Extracted Colors (${v})`),console.log("\u2713 Created new collection:",$.name,"ID:",$.id)}catch(x){throw console.error("Failed to create collection:",x),new Error(`Failed to create collection: ${x.message}`)}}else if(u)if(console.log("Looking for collection with ID:",u),console.log("Available collections:",I.map(v=>({id:v.id,name:v.name}))),$=I.find(v=>v.id===u),$)console.log("\u2713 Using existing collection:",$.name);else{console.error("Collection not found:",u),m({type:"create-variables-from-colors-result",success:!1,error:"Selected collection not found."});return}if(!$)throw new Error("Could not determine variable collection.");let N=$.modes[0].modeId;console.log("Mode ID:",N);let C=(yield figma.variables.getLocalVariablesAsync()).filter(v=>v.variableCollectionId===$.id),w=new Map(C.map(v=>[v.name,v]));console.log(`Processing ${c.length} colors...`);for(let v of c)try{let{color:x,name:A}=v;if(!x||!A){console.error("Invalid color data:",v),b++;continue}console.log(`Creating variable: ${A} with color: ${x}`);let R=w.get(A);if(R)console.log(`Variable already exists: ${A}, updating value`);else try{R=figma.variables.createVariable(A,$,"COLOR"),w.set(A,R),console.log(`Created new variable: ${A}`)}catch(M){throw console.error(`Error creating variable ${A}:`,M),M}try{let{r:M,g:O,b:D}=X(x),G={r:M,g:O,b:D,a:1};R.setValueForMode(N,G),console.log(`Set value for ${A}:`,G),g++}catch(M){throw console.error(`Error setting value for ${A}:`,M),M}}catch(x){console.error(`Failed to create variable ${v.name}:`,x),console.error("Error details:",x.message,x.stack),b++}console.log("Variable creation complete:",{count:g,errorCount:b,collectionName:$.name});let p=b>0?{type:"create-variables-from-colors-result",success:!0,count:g,error:`Created ${g} variables. Failed: ${b}.`}:{type:"create-variables-from-colors-result",success:!0,count:g};clearTimeout(d),m(p),b===0&&figma.notify(`Success! Created ${g} color variables in "${$.name}".`),console.log("=== RESPONSE SENT TO UI ===")}catch(c){clearTimeout(d),console.error("=== ERROR IN CREATE VARIABLES HANDLER ==="),console.error("Error creating variables from colors:",c),console.error("Error name:",c.name),console.error("Error message:",c.message),console.error("Error stack:",c.stack),m({type:"create-variables-from-colors-result",success:!1,error:c.message||"Unknown error"}),console.log("Error response sent to UI")}});return}if(e.type==="create-mode-variables"){if(console.log("=== CREATE MODE VARIABLES HANDLER ==="),console.log("Received data:",{hasModeTokens:!!e.modeTokens,hasModeTokensByMode:!!e.modeTokensByMode,collectionName:e.collectionName}),!figma.variables){figma.ui.postMessage({type:"create-mode-variables-result",success:!1,error:"Variables API is not available in this file."});return}H(null,null,function*(){var i,m,d;try{let c=e.modeTokensByMode||e.modeTokens,u=e.collectionName||`Multi-Mode Colors (${new Date().toLocaleString("en-GB",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"})})`,y=["light","dark","high-contrast"];if(!c)throw new Error("No mode tokens provided");console.log("Mode tokens received:",{light:((i=c.light)==null?void 0:i.length)||0,dark:((m=c.dark)==null?void 0:m.length)||0,"high-contrast":((d=c["high-contrast"])==null?void 0:d.length)||0});let g=figma.variables.createVariableCollection(u);console.log("Created collection:",g.name);let b=g.modes[0].modeId;g.renameMode(b,"Light");let I=g.addMode("Dark"),$=g.addMode("High Contrast"),N={light:b,dark:I.modeId,"high-contrast":$.modeId};console.log("Created modes:",{lightModeId:b,darkModeId:I.modeId,highContrastModeId:$.modeId});let k=new Map,C=0,w=c.light||[];if(w.length===0)throw new Error("No light mode tokens found. Please generate tokens first.");console.log(`Creating ${w.length} variables...`);for(let x of w)try{let A=figma.variables.createVariable(x.name,g,"COLOR");k.set(x.name,A),C++;for(let R of y){let M=N[R],O=(c[R]||[]).find(D=>D.name===x.name);if(O){let{r:D,g:G,b:P}=X(O.value);A.setValueForMode(M,{r:D,g:G,b:P,a:1}),console.log(`Set ${x.name} for ${R}:`,O.value)}}}catch(A){console.error(`Error creating variable ${x.name}:`,A)}console.log(`Created ${C} mode variables with ${y.length} modes`),console.log("Variable map contains:",Array.from(k.keys()));let p=0;if(e.createSemanticTokens&&e.semanticTokensByMode){console.log("Creating semantic tokens as aliases...");let x=e.semanticTokensByMode,A=x.light||[];console.log(`Creating ${A.length} semantic tokens...`),console.log("Sample semantic token:",A[0]);for(let R of A)try{let M=R.name.replace(/\./g,"/"),O=figma.variables.createVariable(M,g,"COLOR");for(let D of y){let G=N[D],P=(x[D]||[]).find(U=>U.name===R.name);if(console.log(`Processing ${M} for ${D}:`,{hasToken:!!P,aliasTo:P==null?void 0:P.aliasTo,value:P==null?void 0:P.value,hasBaseVar:!!k.get((P==null?void 0:P.aliasTo)||"")}),P&&P.aliasTo){let U=k.get(P.aliasTo);if(U)O.setValueForMode(G,{type:"VARIABLE_ALIAS",id:U.id}),console.log(`\u2713 Set semantic ${M} for ${D} as alias to: ${P.aliasTo}`);else{console.warn(`\u2717 Base token "${P.aliasTo}" not found in map (available: ${Array.from(k.keys()).slice(0,5).join(", ")}...), using direct value`);let{r:Y,g:K,b:ae}=X(P.value);O.setValueForMode(G,{r:Y,g:K,b:ae,a:1})}}else if(P){console.log(`No alias info for ${M}, using direct value`);let{r:U,g:Y,b:K}=X(P.value);O.setValueForMode(G,{r:U,g:Y,b:K,a:1}),console.log(`Set semantic ${M} for ${D} (direct value):`,P.value)}}p++}catch(M){console.error(`Error creating semantic token ${R.name}:`,M),console.error("Error details:",M.message)}console.log(`Created ${p} semantic tokens as aliases`)}let v=C+p;figma.ui.postMessage({type:"create-mode-variables-result",success:!0,count:C,semanticCount:p,modes:y.length}),p>0?figma.notify(`Success! Created ${C} mode variables and ${p} semantic tokens with ${y.length} modes in "${g.name}".`):figma.notify(`Success! Created ${C} variables with ${y.length} modes in "${g.name}".`)}catch(c){console.error("=== ERROR IN CREATE MODE VARIABLES ==="),console.error("Error:",c),console.error("Error message:",c.message),console.error("Error stack:",c.stack),figma.ui.postMessage({type:"create-mode-variables-result",success:!1,error:c.message||"Unknown error"}),figma.notify(`Error creating mode variables: ${c.message}`)}});return}e.type==="close"&&figma.closePlugin()});H(null,null,function*(){try{let e=yield figma.clientStorage.getAsync("procolors-brands");figma.ui.postMessage({type:"brands-loaded",brands:e||null})}catch(e){console.error("Error loading brands on start:",e),figma.ui.postMessage({type:"brands-loaded",brands:null,error:e.message})}try{let e=yield figma.clientStorage.getAsync("procolors-active-brand-id");figma.ui.postMessage({type:"active-brand-id-loaded",brandId:e||null})}catch(e){console.error("Error loading active brand ID on start:",e),figma.ui.postMessage({type:"active-brand-id-loaded",brandId:null,error:e.message})}})});ni();})();
